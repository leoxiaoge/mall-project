{"remainingRequest":"/Users/lee/Desktop/github/mall-project/node_modules/babel-loader/lib/index.js!/Users/lee/Desktop/github/mall-project/node_modules/ts-loader/index.js??ref--13-2!/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-3!/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--18-0!/Users/lee/Desktop/github/mall-project/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/lee/Desktop/github/mall-project/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-scoped-loader/index.js!/Users/lee/Desktop/github/mall-project/src/pages/mall/productDetailsPage/productDetailsPage.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/lee/Desktop/github/mall-project/src/pages/mall/productDetailsPage/productDetailsPage.vue","mtime":1563307407761},{"path":"/Users/lee/Desktop/github/mall-project/src/sfc.d.ts","mtime":1560261569183},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/tslib/tslib.d.ts","mtime":1560261193267},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/vue/types/index.d.ts","mtime":1554990780697},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/vue/types/vue.d.ts","mtime":1554990780697},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/vue/types/options.d.ts","mtime":1554990780697},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/vue/types/vnode.d.ts","mtime":1554990780697},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/vue/types/plugin.d.ts","mtime":1554990780697},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/vuex/types/index.d.ts","mtime":1560261210230},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/vuex/types/vue.d.ts","mtime":1560261210230},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/vuex/types/helpers.d.ts","mtime":1560261210230},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/ts-md5/dist/md5.d.ts","mtime":1560260225015},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/types/uni-app/index.d.ts","mtime":1561751962243},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/types/uni-app/app.d.ts","mtime":1561751962243},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/types/uni-app/common.d.ts","mtime":1561751962243},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/types/uni-app/page.d.ts","mtime":1561751962243},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/types/uni-app/uni.d.ts","mtime":1561751962243},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/types/uni-app/vue.d.ts","mtime":1561751962243},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/types/html5plus/plus.d.ts","mtime":1561751962243},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/@types/webpack-env/index.d.ts","mtime":1560260225565},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.esnext.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2019.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2018.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2017.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2016.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2015.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es5.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2015.core.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2015.collection.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2015.generator.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2015.promise.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2015.iterable.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2015.symbol.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2015.proxy.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2015.reflect.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2015.symbol.wellknown.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2016.array.include.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2017.object.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2017.sharedmemory.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2017.string.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2017.intl.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2017.typedarrays.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2018.asynciterable.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2018.promise.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2018.regexp.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2018.intl.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2019.array.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2019.object.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2019.string.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2019.symbol.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.esnext.bigint.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.esnext.intl.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.dom.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.dom.iterable.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.scripthost.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/tslib/tslib.d.ts","mtime":1560261193267},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/vue/types/index.d.ts","mtime":1554990780697},{"path":"/Users/lee/Desktop/github/mall-project/src/common/utils/util.ts","mtime":1563199410488},{"path":"/Users/lee/Desktop/github/mall-project/src/common/config/api.ts","mtime":1563197205512},{"path":"/Users/lee/Desktop/github/mall-project/src/components/i-past/i-past.vue","mtime":1563100949135},{"path":"/Users/lee/Desktop/github/mall-project/src/components/i-show/i-show.vue","mtime":1563112601167},{"path":"/Users/lee/Desktop/github/mall-project/src/components/i-rule/i-rule.vue","mtime":1563110094693},{"path":"/Users/lee/Desktop/github/mall-project/src/components/i-popup/i-popup.vue","mtime":1563122597707},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/cache-loader/dist/cjs.js","mtime":1554990705312},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/babel-loader/lib/index.js","mtime":1560261191357},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/ts-loader/index.js","mtime":1560261210667},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js","mtime":1561751947145},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js","mtime":1561751947145},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/cache-loader/dist/cjs.js","mtime":1554990705312},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/vue-loader/lib/index.js","mtime":1554990705750},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-scoped-loader/index.js","mtime":1561751947145}],"contextDependencies":[],"result":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"/Users/lee/Desktop/github/mall-project/node_modules/@babel/runtime/regenerator\"));\n\nvar _vue = _interopRequireDefault(require(\"vue\"));\n\nvar _util = require(\"@/common/utils/util\");\n\nvar _api = require(\"@/common/config/api\");\n\nvar _iPast = _interopRequireDefault(require(\"@/components/i-past/i-past.vue\"));\n\nvar _iShow = _interopRequireDefault(require(\"@/components/i-show/i-show.vue\"));\n\nvar _iRule = _interopRequireDefault(require(\"@/components/i-rule/i-rule.vue\"));\n\nvar _iPopup = _interopRequireDefault(require(\"@/components/i-popup/i-popup.vue\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nvar socketOpen = false;\nvar socketMsgQueue = [];\n\nvar _default = _vue.default.extend({\n  components: {\n    iPast: _iPast.default,\n    iShow: _iShow.default,\n    iRule: _iRule.default,\n    iPopup: _iPopup.default\n  },\n  data: function data() {\n    return {\n      indicatorDots: true,\n      autoplay: true,\n      interval: 2000,\n      duration: 500,\n      circular: true,\n      indicatorActiveColor: \"#fe7f00\",\n      disabled: false,\n      swiper: [],\n      title: \"服务\",\n      id: \"\",\n      product: \"\",\n      num: \"9999\",\n      tabIndex: 0,\n      pastList: [],\n      showList: [],\n      ruleList: \"\",\n      show: false,\n      label: [\"零风险\", \"正品承诺\", \"极速发货\", \"公平公正\"],\n      tab: [\"往期成交\", \"分享晒单\", \"竞拍规则\"],\n      src: \"/static/icon_experience.png\",\n      leading: \"/static/icon/icon_leading.png\"\n    };\n  },\n  onLoad: function onLoad(options) {\n    this.id = options.id;\n    this.getProduct();\n    this.getPastTransactionsList();\n    this.getOrderDryingList();\n    this.websocket();\n  },\n  methods: {\n    // 获取产品详情\n    getProduct: function getProduct() {\n      var _this = this;\n\n      var ProductID = this.id;\n      var data = {\n        ProductID: ProductID\n      };\n      (0, _util.request)(_api.ProductGet, data).then(function (res) {\n        console.log(res);\n        _this.product = res.Product;\n        _this.swiper = res.Product.ProductPicList;\n      });\n    },\n    // 选项卡\n    tabClick: function tabClick(index) {\n      this.tabIndex = index;\n    },\n    // 往期成交列表\n    getPastTransactionsList: function getPastTransactionsList() {\n      var _this2 = this;\n\n      var ProductID = this.id;\n      var data = {\n        ProductID: ProductID\n      };\n      (0, _util.request)(_api.PastTransactionsListGet, data).then(function (res) {\n        console.log(res);\n        var pastList = res.OrderList;\n        pastList.map(function (item) {\n          item.percentage = (item.OrderMoneys / item.OrderPrimeCost * 100).toFixed(2);\n        });\n        _this2.pastList = pastList;\n      });\n    },\n    change: function change(val) {\n      console.log(val);\n    },\n    hidePopup: function hidePopup() {\n      this.show = !this.show;\n    },\n    // 获取用户晒单列表\n    getOrderDryingList: function getOrderDryingList() {\n      var _this3 = this;\n\n      var ProductID = this.id;\n      var data = {\n        ProductID: ProductID\n      };\n      (0, _util.request)(_api.OrderDryingListGet, data).then(function (res) {\n        _this3.showList = res.OrderList;\n      });\n    },\n    activePath: function activePath() {\n      var id = this.id;\n      (0, _util.navigateTo)(\"../activeBilList/activeBilList?id=\" + id);\n    },\n    productDetailsUparsePath: function productDetailsUparsePath() {\n      var id = this.id;\n      (0, _util.navigateTo)(\"../productDetailsUparse/productDetailsUparse?id=\" + id);\n    },\n    // websocket连接\n    websocket: function () {\n      var _websocket = _asyncToGenerator(\n      /*#__PURE__*/\n      _regenerator.default.mark(function _callee() {\n        var msgLogin, msgSubscribe, sendSocketMessage;\n        return _regenerator.default.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                sendSocketMessage = function _ref(msg) {\n                  console.log(\"发送数据\", socketOpen, msg);\n\n                  if (socketOpen) {\n                    uni.sendSocketMessage({\n                      data: msg\n                    });\n                  } else {\n                    socketMsgQueue.push(msg);\n                  }\n                };\n\n                _context.next = 3;\n                return this.reqLogin();\n\n              case 3:\n                msgLogin = _context.sent;\n                _context.next = 6;\n                return this.msgSubscribe();\n\n              case 6:\n                msgSubscribe = _context.sent;\n                uni.connectSocket({\n                  url: \"wss://websocket.tengpaisc.com:8888/\"\n                });\n                uni.onSocketOpen(function (res) {\n                  console.log(\"WebSocket连接已打开！\", \"握手成功！\");\n                  socketOpen = true;\n\n                  for (var i = 0; i < socketMsgQueue.length; i++) {\n                    sendSocketMessage(socketMsgQueue[i]);\n                  }\n\n                  socketMsgQueue = [];\n                  sendSocketMessage(msgLogin);\n                  sendSocketMessage(msgSubscribe);\n                });\n                uni.onSocketError(function (res) {\n                  console.log(\"WebSocket连接打开失败，请检查！\");\n                });\n                return _context.abrupt(\"return\", new Promise(function (sesolve, reject) {\n                  uni.onSocketMessage(function (res) {\n                    console.log(\"收到服务器内容：\" + res.data);\n                    var data = JSON.parse(res.data);\n                    console.log(data);\n                    sesolve(data);\n                  });\n                }));\n\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function websocket() {\n        return _websocket.apply(this, arguments);\n      }\n\n      return websocket;\n    }(),\n    // 向服务器发送登录请求\n    reqLogin: function () {\n      var _reqLogin = _asyncToGenerator(\n      /*#__PURE__*/\n      _regenerator.default.mark(function _callee2() {\n        var GUID;\n        return _regenerator.default.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return this.GUID();\n\n              case 2:\n                GUID = _context2.sent;\n                return _context2.abrupt(\"return\", new Promise(function (sesolve, reject) {\n                  var Appkey = \"3957399\";\n                  var SessionKey = uni.getStorageSync(\"SessionKey\");\n                  var ActiveID = 1;\n                  var UserID = 0;\n                  var ConnectionState = false;\n                  var msgTime = (0, _util.formatTime)(new Date());\n                  console.log(GUID);\n                  var reqLogin = {\n                    ActiveID: ActiveID,\n                    AppKey: Appkey,\n                    SessionKey: SessionKey,\n                    msgID: GUID,\n                    msgType: 3,\n                    msgTime: msgTime\n                  };\n                  var msgLogin = JSON.stringify(reqLogin);\n                  sesolve(msgLogin);\n                }));\n\n              case 4:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function reqLogin() {\n        return _reqLogin.apply(this, arguments);\n      }\n\n      return reqLogin;\n    }(),\n    // 发送对该活动的消息订阅\n    msgSubscribe: function () {\n      var _msgSubscribe = _asyncToGenerator(\n      /*#__PURE__*/\n      _regenerator.default.mark(function _callee3() {\n        var GUID;\n        return _regenerator.default.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return this.GUID();\n\n              case 2:\n                GUID = _context3.sent;\n                return _context3.abrupt(\"return\", new Promise(function (sesolve, reject) {\n                  var ActiveID = 1;\n                  var url = \"/Actives/\" + ActiveID + \"/\";\n                  var msgTime = (0, _util.formatTime)(new Date());\n                  var reqSubscribe = {\n                    Subscribe: url,\n                    msgID: GUID,\n                    msgType: 0,\n                    msgTime: msgTime\n                  };\n                  var msgSubscribe = JSON.stringify(reqSubscribe);\n                  sesolve(msgSubscribe);\n                }));\n\n              case 4:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function msgSubscribe() {\n        return _msgSubscribe.apply(this, arguments);\n      }\n\n      return msgSubscribe;\n    }(),\n    //下面是生成随机GUID的函数\n    GUID: function GUID() {\n      return new Promise(function (sesolve, reject) {\n        var guid = \"\";\n\n        for (var i = 1; i <= 32; i++) {\n          var n = Math.floor(Math.random() * 16.0).toString(16);\n          guid += n;\n          if (i == 8 || i == 12 || i == 16 || i == 20) guid += \"-\";\n        }\n\n        sesolve(guid);\n      });\n    },\n    // 举牌消息，通常是用户点击UI上的举牌按钮后，会触发此事件\n    bill: function bill() {\n      var msgTime = (0, _util.formatTime)(new Date());\n      var billMsg = {\n        ActiveID: this.ActiveID,\n        Price: this.Price,\n        msgID: this.msgID,\n        msgType: 2,\n        msgTime: msgTime\n      };\n    }\n  }\n});\n\nexports.default = _default;",{"version":3,"sources":["/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-3!/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--18-0!/Users/lee/Desktop/github/mall-project/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/lee/Desktop/github/mall-project/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-scoped-loader/index.js!/Users/lee/Desktop/github/mall-project/src/pages/mall/productDetailsPage/productDetailsPage.vue?vue&type=script&lang=ts&"],"names":[],"mappings":"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","sourcesContent":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from \"vue\";\nimport { request, navigateTo, formatTime } from \"@/common/utils/util\";\nimport {\n\tProductGet,\n\tPastTransactionsListGet,\n\tOrderDryingListGet\n} from \"@/common/config/api\";\nimport iPast from \"@/components/i-past/i-past.vue\";\nimport iShow from \"@/components/i-show/i-show.vue\";\nimport iRule from \"@/components/i-rule/i-rule.vue\";\nimport iPopup from \"@/components/i-popup/i-popup.vue\";\nlet socketOpen: boolean = false;\nlet socketMsgQueue: any = [];\nexport default Vue.extend({\n\tcomponents: {\n\t\tiPast,\n\t\tiShow,\n\t\tiRule,\n\t\tiPopup\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tindicatorDots: true,\n\t\t\tautoplay: true,\n\t\t\tinterval: 2000,\n\t\t\tduration: 500,\n\t\t\tcircular: true,\n\t\t\tindicatorActiveColor: \"#fe7f00\",\n\t\t\tdisabled: false, // 按钮disabled\n\n\t\t\tswiper: [],\n\t\t\ttitle: \"服务\",\n\t\t\tid: \"\",\n\t\t\tproduct: \"\",\n\t\t\tnum: \"9999\", // 剩余次数\n\n\t\t\ttabIndex: 0, // 默认往期成交\n\t\t\tpastList: [], // 往期成交列表\n\t\t\tshowList: [], // 晒单列表\n\t\t\truleList: \"\", // 竞拍规则\n\t\t\tshow: false, // 显示弹窗\n\n\t\t\tlabel: [\"零风险\", \"正品承诺\", \"极速发货\", \"公平公正\"],\n\t\t\ttab: [\"往期成交\", \"分享晒单\", \"竞拍规则\"],\n\t\t\tsrc: \"/static/icon_experience.png\",\n\t\t\tleading: \"/static/icon/icon_leading.png\",\n\n\t\t};\n\t},\n\tonLoad(options: any) {\n\t\tthis.id = options.id;\n\t\tthis.getProduct();\n\t\tthis.getPastTransactionsList();\n\t\tthis.getOrderDryingList();\n\t\tthis.websocket();\n\t},\n\tmethods: {\n\t\t// 获取产品详情\n\t\tgetProduct() {\n\t\t\tlet ProductID = this.id;\n\t\t\tlet data = {\n\t\t\t\tProductID: ProductID\n\t\t\t};\n\t\t\trequest(ProductGet, data).then((res: any) => {\n\t\t\t\tconsole.log(res);\n\t\t\t\tthis.product = res.Product;\n\t\t\t\tthis.swiper = res.Product.ProductPicList;\n\t\t\t});\n\t\t},\n\t\t// 选项卡\n\t\ttabClick(index: number) {\n\t\t\tthis.tabIndex = index;\n\t\t},\n\t\t// 往期成交列表\n\t\tgetPastTransactionsList() {\n\t\t\tlet ProductID = this.id;\n\t\t\tlet data = {\n\t\t\t\tProductID: ProductID\n\t\t\t};\n\t\t\trequest(PastTransactionsListGet, data).then((res: any) => {\n\t\t\t\tconsole.log(res);\n\t\t\t\tlet pastList = res.OrderList;\n\t\t\t\tpastList.map((item: any) => {\n\t\t\t\t\titem.percentage = (\n\t\t\t\t\t\t(item.OrderMoneys / item.OrderPrimeCost) *\n\t\t\t\t\t\t100\n\t\t\t\t\t).toFixed(2);\n\t\t\t\t});\n\t\t\t\tthis.pastList = pastList;\n\t\t\t});\n\t\t},\n\t\tchange(val: any) {\n\t\t\tconsole.log(val);\n\t\t},\n\t\thidePopup() {\n\t\t\tthis.show = !this.show;\n\t\t},\n\t\t// 获取用户晒单列表\n\t\tgetOrderDryingList() {\n\t\t\tlet ProductID = this.id;\n\t\t\tlet data = {\n\t\t\t\tProductID: ProductID\n\t\t\t};\n\t\t\trequest(OrderDryingListGet, data).then((res: any) => {\n\t\t\t\tthis.showList = res.OrderList;\n\t\t\t});\n\t\t},\n\t\tactivePath() {\n\t\t\tlet id = this.id;\n\t\t\tnavigateTo(\"../activeBilList/activeBilList?id=\" + id);\n\t\t},\n\t\tproductDetailsUparsePath() {\n\t\t\tlet id = this.id;\n\t\t\tnavigateTo(\"../productDetailsUparse/productDetailsUparse?id=\" + id);\n\t\t},\n\t\t// websocket连接\n\t\tasync websocket() {\n\t\t\tlet msgLogin = await this.reqLogin();\n\t\t\tlet msgSubscribe = await this.msgSubscribe();\n\t\t\tuni.connectSocket({\n\t\t\t\turl: \"wss://websocket.tengpaisc.com:8888/\"\n\t\t\t});\n\t\t\tuni.onSocketOpen((res: any) => {\n\t\t\t\tconsole.log(\"WebSocket连接已打开！\", \"握手成功！\");\n\t\t\t\tsocketOpen = true;\n\t\t\t\tfor (let i = 0; i < socketMsgQueue.length; i++) {\n\t\t\t\t\tsendSocketMessage(socketMsgQueue[i]);\n\t\t\t\t}\n\t\t\t\tsocketMsgQueue = [];\n\t\t\t\tsendSocketMessage(msgLogin);\n\t\t\t\tsendSocketMessage(msgSubscribe);\n\t\t\t});\n\t\t\tuni.onSocketError(res => {\n\t\t\t\tconsole.log(\"WebSocket连接打开失败，请检查！\");\n\t\t\t});\n\t\t\tfunction sendSocketMessage(msg: any) {\n\t\t\t\tconsole.log(\"发送数据\", socketOpen, msg);\n\t\t\t\tif (socketOpen) {\n\t\t\t\t\tuni.sendSocketMessage({\n\t\t\t\t\t\tdata: msg\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tsocketMsgQueue.push(msg);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn new Promise((sesolve, reject) => {\n\t\t\t\tuni.onSocketMessage((res: any) => {\n\t\t\t\t\tconsole.log(\"收到服务器内容：\" + res.data);\n\t\t\t\t\tlet data = JSON.parse(res.data);\n\t\t\t\t\tconsole.log(data);\n\t\t\t\t\tsesolve(data)\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t// 向服务器发送登录请求\n\t\tasync reqLogin() {\n\t\t\tlet GUID: any = await this.GUID();\n\t\t\treturn new Promise((sesolve, reject) => {\n\t\t\t\tconst Appkey = \"3957399\";\n\t\t\t\tconst SessionKey = uni.getStorageSync(\"SessionKey\");\n\t\t\t\tlet ActiveID = 1;\n\t\t\t\tlet UserID = 0;\n\t\t\t\tlet ConnectionState = false;\n\t\t\t\tlet msgTime = formatTime(new Date());\n\t\t\t\tconsole.log(GUID);\n\t\t\t\tlet reqLogin: any = {\n\t\t\t\t\tActiveID: ActiveID,\n\t\t\t\t\tAppKey: Appkey,\n\t\t\t\t\tSessionKey: SessionKey,\n\t\t\t\t\tmsgID: GUID,\n\t\t\t\t\tmsgType: 3,\n\t\t\t\t\tmsgTime: msgTime\n\t\t\t\t};\n\t\t\t\tlet msgLogin = JSON.stringify(reqLogin);\n\t\t\t\tsesolve(msgLogin);\n\t\t\t});\n\t\t},\n\t\t// 发送对该活动的消息订阅\n\t\tasync msgSubscribe() {\n\t\t\tlet GUID: any = await this.GUID();\n\t\t\treturn new Promise((sesolve, reject) => {\n\t\t\t\tlet ActiveID = 1;\n\t\t\t\tlet url = \"/Actives/\" + ActiveID + \"/\";\n\t\t\t\tlet msgTime = formatTime(new Date());\n\t\t\t\tlet reqSubscribe = {\n\t\t\t\t\tSubscribe: url,\n\t\t\t\t\tmsgID: GUID,\n\t\t\t\t\tmsgType: 0,\n\t\t\t\t\tmsgTime: msgTime\n\t\t\t\t};\n\t\t\t\tlet msgSubscribe = JSON.stringify(reqSubscribe);\n\t\t\t\tsesolve(msgSubscribe);\n\t\t\t});\n\t\t},\n\t\t//下面是生成随机GUID的函数\n\t\tGUID() {\n\t\t\treturn new Promise((sesolve, reject) => {\n\t\t\t\tlet guid = \"\";\n\t\t\t\tfor (let i = 1; i <= 32; i++) {\n\t\t\t\t\tlet n = Math.floor(Math.random() * 16.0).toString(16);\n\t\t\t\t\tguid += n;\n\t\t\t\t\tif (i == 8 || i == 12 || i == 16 || i == 20) guid += \"-\";\n\t\t\t\t}\n\t\t\t\tsesolve(guid);\n\t\t\t});\n\t\t},\n\t\t// 举牌消息，通常是用户点击UI上的举牌按钮后，会触发此事件\n\t\tbill() {\n\t\t\tlet msgTime = formatTime(new Date());\n\t\t\tlet billMsg = {\n\t\t\t\tActiveID: this.ActiveID,\n\t\t\t\tPrice: this.Price,\n\t\t\t\tmsgID: this.msgID,\n\t\t\t\tmsgType: 2,\n\t\t\t\tmsgTime: msgTime\n\t\t\t}\n\t\t}\n\t}\n});\n"],"sourceRoot":""}]}