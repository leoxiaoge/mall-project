{"remainingRequest":"/Users/lee/Desktop/github/mall-project/node_modules/babel-loader/lib/index.js!/Users/lee/Desktop/github/mall-project/node_modules/ts-loader/index.js??ref--13-2!/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-3!/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--18-0!/Users/lee/Desktop/github/mall-project/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/lee/Desktop/github/mall-project/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-scoped-loader/index.js!/Users/lee/Desktop/github/mall-project/src/pages/mall/productDetailsPage/productDetailsPage.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/lee/Desktop/github/mall-project/src/pages/mall/productDetailsPage/productDetailsPage.vue","mtime":1563383567773},{"path":"/Users/lee/Desktop/github/mall-project/src/sfc.d.ts","mtime":1560261569183},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/tslib/tslib.d.ts","mtime":1560261193267},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/vue/types/index.d.ts","mtime":1554990780697},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/vue/types/vue.d.ts","mtime":1554990780697},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/vue/types/options.d.ts","mtime":1554990780697},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/vue/types/vnode.d.ts","mtime":1554990780697},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/vue/types/plugin.d.ts","mtime":1554990780697},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/vuex/types/index.d.ts","mtime":1560261210230},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/vuex/types/vue.d.ts","mtime":1560261210230},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/vuex/types/helpers.d.ts","mtime":1560261210230},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/ts-md5/dist/md5.d.ts","mtime":1560260225015},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/types/uni-app/index.d.ts","mtime":1561751962243},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/types/uni-app/app.d.ts","mtime":1561751962243},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/types/uni-app/common.d.ts","mtime":1561751962243},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/types/uni-app/page.d.ts","mtime":1561751962243},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/types/uni-app/uni.d.ts","mtime":1561751962243},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/types/uni-app/vue.d.ts","mtime":1561751962243},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/types/html5plus/plus.d.ts","mtime":1561751962243},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/@types/webpack-env/index.d.ts","mtime":1560260225565},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.esnext.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2019.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2018.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2017.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2016.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2015.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es5.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2015.core.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2015.collection.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2015.generator.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2015.promise.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2015.iterable.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2015.symbol.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2015.proxy.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2015.reflect.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2015.symbol.wellknown.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2016.array.include.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2017.object.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2017.sharedmemory.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2017.string.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2017.intl.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2017.typedarrays.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2018.asynciterable.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2018.promise.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2018.regexp.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2018.intl.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2019.array.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2019.object.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2019.string.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.es2019.symbol.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.esnext.bigint.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.esnext.intl.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.dom.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.dom.iterable.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/typescript/lib/lib.scripthost.d.ts","mtime":1561751962825},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/tslib/tslib.d.ts","mtime":1560261193267},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/vue/types/index.d.ts","mtime":1554990780697},{"path":"/Users/lee/Desktop/github/mall-project/src/common/utils/util.ts","mtime":1563382434868},{"path":"/Users/lee/Desktop/github/mall-project/src/common/config/api.ts","mtime":1563197205512},{"path":"/Users/lee/Desktop/github/mall-project/src/components/i-past/i-past.vue","mtime":1563100949135},{"path":"/Users/lee/Desktop/github/mall-project/src/components/i-show/i-show.vue","mtime":1563112601167},{"path":"/Users/lee/Desktop/github/mall-project/src/components/i-rule/i-rule.vue","mtime":1563110094693},{"path":"/Users/lee/Desktop/github/mall-project/src/components/i-popup/i-popup.vue","mtime":1563122597707},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/cache-loader/dist/cjs.js","mtime":1554990705312},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/babel-loader/lib/index.js","mtime":1560261191357},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/ts-loader/index.js","mtime":1560261210667},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js","mtime":1561751947145},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js","mtime":1561751947145},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/cache-loader/dist/cjs.js","mtime":1554990705312},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/vue-loader/lib/index.js","mtime":1554990705750},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-scoped-loader/index.js","mtime":1561751947145}],"contextDependencies":[],"result":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"/Users/lee/Desktop/github/mall-project/node_modules/@babel/runtime/regenerator\"));\n\nvar _vue = _interopRequireDefault(require(\"vue\"));\n\nvar _util = require(\"@/common/utils/util\");\n\nvar _api = require(\"@/common/config/api\");\n\nvar _iPast = _interopRequireDefault(require(\"@/components/i-past/i-past.vue\"));\n\nvar _iShow = _interopRequireDefault(require(\"@/components/i-show/i-show.vue\"));\n\nvar _iRule = _interopRequireDefault(require(\"@/components/i-rule/i-rule.vue\"));\n\nvar _iPopup = _interopRequireDefault(require(\"@/components/i-popup/i-popup.vue\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nvar socketOpen = false;\nvar socketMsgQueue = [];\n\nvar _default = _vue.default.extend({\n  components: {\n    iPast: _iPast.default,\n    iShow: _iShow.default,\n    iRule: _iRule.default,\n    iPopup: _iPopup.default\n  },\n  data: function data() {\n    return {\n      indicatorDots: true,\n      autoplay: true,\n      interval: 2000,\n      duration: 500,\n      circular: true,\n      indicatorActiveColor: \"#fe7f00\",\n      disabled: false,\n      swiper: [],\n      title: \"服务\",\n      id: \"\",\n      product: \"\",\n      num: \"9999\",\n      tabIndex: 0,\n      pastList: [],\n      showList: [],\n      ruleList: \"\",\n      show: false,\n      label: [\"零风险\", \"正品承诺\", \"极速发货\", \"公平公正\"],\n      tab: [\"往期成交\", \"分享晒单\", \"竞拍规则\"],\n      src: \"/static/icon_experience.png\",\n      leading: \"/static/icon/icon_leading.png\",\n      ActiveID: \"\",\n      Price: \"\",\n      msgID: \"\",\n      msgType: \"\",\n      seq: \"\",\n      MyBills: \"\",\n      UserID: \"\",\n      tapbtn: \"\",\n      BillStat: \"\",\n      newprice: \"\",\n      newbill: \"\",\n      lastbills: [],\n      times: \"\",\n      seqTime: new Date(\"2019/7/20 10:29:35\")\n    };\n  },\n  onLoad: function onLoad(options) {\n    this.id = options.id;\n    this.ActiveID = options.id;\n    this.UserID = uni.getStorageSync(\"SessionKey\").ID;\n    this.getProduct();\n    this.getPastTransactionsList();\n    this.getOrderDryingList();\n    this.websocket();\n  },\n  methods: {\n    // 获取产品详情\n    getProduct: function getProduct() {\n      var _this = this;\n\n      var ProductID = this.id;\n      var data = {\n        ProductID: ProductID\n      };\n      (0, _util.request)(_api.ProductGet, data).then(function (res) {\n        console.log(\"获取产品详情\", res);\n        _this.product = res.Product;\n        _this.swiper = res.Product.ProductPicList;\n        _this.Price = res.Product.ProductPrice;\n      });\n    },\n    // 选项卡\n    tabClick: function tabClick(index) {\n      this.tabIndex = index;\n    },\n    // 往期成交列表\n    getPastTransactionsList: function getPastTransactionsList() {\n      var _this2 = this;\n\n      var ProductID = this.id;\n      var data = {\n        ProductID: ProductID\n      };\n      (0, _util.request)(_api.PastTransactionsListGet, data).then(function (res) {\n        console.log(res);\n        var pastList = res.OrderList;\n        pastList.map(function (item) {\n          item.percentage = (item.OrderMoneys / item.OrderPrimeCost * 100).toFixed(2);\n        });\n        _this2.pastList = pastList;\n      });\n    },\n    change: function change(val) {\n      console.log(val);\n    },\n    hidePopup: function hidePopup() {\n      this.show = !this.show;\n    },\n    // 获取用户晒单列表\n    getOrderDryingList: function getOrderDryingList() {\n      var _this3 = this;\n\n      var ProductID = this.id;\n      var data = {\n        ProductID: ProductID\n      };\n      (0, _util.request)(_api.OrderDryingListGet, data).then(function (res) {\n        _this3.showList = res.OrderList;\n      });\n    },\n    activePath: function activePath() {\n      var id = this.id;\n      (0, _util.navigateTo)(\"../activeBilList/activeBilList?id=\" + id);\n    },\n    productDetailsUparsePath: function productDetailsUparsePath() {\n      var id = this.id;\n      (0, _util.navigateTo)(\"../productDetailsUparse/productDetailsUparse?id=\" + id);\n    },\n    websocket: function websocket() {\n      var _this4 = this;\n\n      uni.connectSocket({\n        url: \"wss://websocket.tengpaisc.com:8888/\"\n      });\n      uni.onSocketOpen(function (res) {\n        console.log(\"WebSocket连接已打开！\");\n        socketOpen = true;\n\n        for (var i = 0; i < socketMsgQueue.length; i++) {\n          _this4.sendSocketMessage(socketMsgQueue[i]);\n        }\n\n        socketMsgQueue = [];\n\n        _this4.reqLogin();\n\n        _this4.msgSubscribe();\n      });\n      uni.onSocketError(function (res) {\n        console.log(\"WebSocket连接打开失败，请检查！\");\n      });\n      this.onSocketMessage();\n    },\n    sendSocketMessage: function sendSocketMessage(msg) {\n      var data = JSON.stringify(msg);\n      console.log(\"发送数据\", socketOpen, msg);\n\n      if (socketOpen) {\n        uni.sendSocketMessage({\n          data: data\n        });\n      } else {\n        socketMsgQueue.push(msg);\n      }\n    },\n    onSocketMessage: function onSocketMessage() {\n      var _this5 = this;\n\n      return new Promise(function (sesolve, reject) {\n        uni.onSocketMessage(function (res) {\n          console.log(\"收到服务器内容：\" + res.data);\n          var msg = JSON.parse(res.data);\n          console.log(msg);\n\n          _this5.proccessMsg();\n\n          sesolve(msg);\n        });\n      });\n    },\n    // 向服务器发送登录请求\n    reqLogin: function () {\n      var _reqLogin = _asyncToGenerator(\n      /*#__PURE__*/\n      _regenerator.default.mark(function _callee() {\n        var GUID, Appkey, SessionKey, ActiveID, UserID, ConnectionState, msgTime, reqLogin;\n        return _regenerator.default.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this.GUID();\n\n              case 2:\n                GUID = _context.sent;\n                Appkey = \"3957399\";\n                SessionKey = uni.getStorageSync(\"SessionKey\");\n                ActiveID = this.ActiveID;\n                UserID = this.UserID;\n                ConnectionState = false;\n                msgTime = (0, _util.formatTime)(new Date());\n                console.log(GUID);\n                reqLogin = {\n                  ActiveID: ActiveID,\n                  AppKey: Appkey,\n                  SessionKey: SessionKey,\n                  msgID: GUID,\n                  msgType: 3,\n                  msgTime: msgTime\n                };\n                this.sendSocketMessage(reqLogin);\n\n              case 12:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function reqLogin() {\n        return _reqLogin.apply(this, arguments);\n      }\n\n      return reqLogin;\n    }(),\n    // 发送对该活动的消息订阅\n    msgSubscribe: function () {\n      var _msgSubscribe = _asyncToGenerator(\n      /*#__PURE__*/\n      _regenerator.default.mark(function _callee2() {\n        var GUID, ActiveID, url, msgTime, reqSubscribe;\n        return _regenerator.default.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return this.GUID();\n\n              case 2:\n                GUID = _context2.sent;\n                ActiveID = this.ActiveID;\n                url = \"/Actives/\" + ActiveID + \"/\";\n                msgTime = (0, _util.formatTime)(new Date());\n                reqSubscribe = {\n                  Subscribe: url,\n                  msgID: GUID,\n                  msgType: 0,\n                  msgTime: msgTime\n                };\n                this.sendSocketMessage(reqSubscribe);\n\n              case 8:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function msgSubscribe() {\n        return _msgSubscribe.apply(this, arguments);\n      }\n\n      return msgSubscribe;\n    }(),\n    // 处理消息的函数，用于解析从服务器webSocket收到的各种消息\n    proccessMsg: function () {\n      var _proccessMsg = _asyncToGenerator(\n      /*#__PURE__*/\n      _regenerator.default.mark(function _callee3() {\n        var msg, timerState, msgType, _dt, tm, dt, dt_time;\n\n        return _regenerator.default.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return this.onSocketMessage();\n\n              case 2:\n                msg = _context3.sent;\n                _context3.next = 5;\n                return this.timerState();\n\n              case 5:\n                timerState = _context3.sent;\n                msgType = msg.msgType;\n                this.msgType = msgType;\n                _context3.prev = 8;\n                _context3.t0 = msgType;\n                _context3.next = _context3.t0 === 0 ? 12 : _context3.t0 === 1 ? 14 : _context3.t0 === 2 ? 17 : _context3.t0 === 3 ? 19 : _context3.t0 === 4 ? 21 : _context3.t0 === 5 ? 23 : _context3.t0 === 8 ? 25 : _context3.t0 === 9 ? 31 : _context3.t0 === 10 ? 36 : _context3.t0 === 11 ? 40 : 44;\n                break;\n\n              case 12:\n                // 订阅响应消息\n                if (msg.IsError) {\n                  (0, _util.showToast)(\"订阅失败：\" + msg.ErrMsg);\n                } else {\n                  (0, _util.showToast)(msg.ErrMsg);\n                }\n\n                return _context3.abrupt(\"break\", 44);\n\n              case 14:\n                // 报名响应消息\n                if (msg.IsError) {\n                  (0, _util.showToast)(\"报名失败：\" + msg.ErrMsg);\n                } else {\n                  (0, _util.showToast)(msg.ErrMsg);\n                } // 更新我的剩余举牌次数\n\n\n                this.seq = \"剩余举牌次数：\" + msg.SeqBills + \"次，已报名份数：\" + msg.Signups + \"份，还可报名：\" + msg.SeqSignups + \"份\";\n                return _context3.abrupt(\"break\", 44);\n\n              case 17:\n                // 举牌响应消息（包含我的举牌次数、剩余可用次数）\n                if (msg.IsError) {\n                  (0, _util.showToast)(msg.ErrMsg);\n                } else {\n                  this.MyBills = \"我的举牌次数：\" + msg.MyBills + \"次，剩余可用次数：\" + msg.SeqBills + \"次\";\n                  (0, _util.showToast)(msg.ErrMsg);\n                }\n\n                return _context3.abrupt(\"break\", 44);\n\n              case 19:\n                // 登录响应消息\n                if (msg.IsError) {\n                  (0, _util.showToast)(\"登录失败：\" + msg.ErrMsg);\n                } else {\n                  // 登录成功，提示用户\n                  this.UserID = msg.UserID;\n                  (0, _util.showToast)(msg.ErrMsg);\n                }\n\n                return _context3.abrupt(\"break\", 44);\n\n              case 21:\n                // 托管响应\n                if (msg.IsError) {\n                  (0, _util.showToast)(\"托管失败!\" + msg.ErrMsg);\n                } else {\n                  this.tapbtn = \"取消托管\";\n                }\n\n                return _context3.abrupt(\"break\", 44);\n\n              case 23:\n                // 取消托管响应消息\n                if (msg.IsError) {\n                  (0, _util.showToast)(\"取消托管失败!\");\n                } else {\n                  this.tapbtn = \"取消托管\";\n                }\n\n                return _context3.abrupt(\"break\", 44);\n\n              case 25:\n                // 价格更新通知\n                (0, _util.showToast)(\"价格已更新......！\"); // 更新全部举牌次数、我的举牌次数、和最新价格\n\n                this.BillStat = \"总举牌次数：\" + msg.AllBills + \"次\"; // 更新最后出价人信息\n\n                if (msg.Bills.length > 0) {\n                  this.newprice = \"￥\" + msg.Bills[0].Price;\n                  this.newbill = \"领先人：\" + msg.Bills[0].City; // 计算剩余时长\n\n                  _dt = new Date();\n                  tm = _dt.getTime() + msg.SeqMiniSecounds;\n                  this.seqTime.setTime(tm);\n                } // 更新最近出局人信息\n\n\n                if (msg.Bills.length > 1) {\n                  this.lastbills = msg.Bills;\n                } // 判断是否需要启动计时器，如果只有一个出价，肯定就是需要启动的，因为计时器未启动\n\n\n                if (msg.Bills.length === 1) {\n                  this.timerState();\n                }\n\n                return _context3.abrupt(\"break\", 44);\n\n              case 31:\n                //计算剩余时间，并重置剩余时间\n                dt = new Date();\n                dt_time = dt.getTime();\n                this.seqTime.setTime(dt_time + msg.SeqMiniSecounds);\n                console.log(this.seqTime);\n                return _context3.abrupt(\"break\", 44);\n\n              case 36:\n                // 活动正式开始，但是目前尚未有人出价，所以收到此消息，先停止计时器，并显示为 “等待先手”\n                clearInterval(timerState);\n                this.times = \"等待首牌\";\n                this.newprice = \"￥\" + msg.currPrice;\n                return _context3.abrupt(\"break\", 44);\n\n              case 40:\n                // 活动结束通知\n                clearInterval(timerState);\n                this.times = \"已成交\"; // 判断是否当前用户，如果是当前用户，则需要弹出收货地址和订单信息处理界面\n\n                if (this.UserID === msg.WinsBill.UserID) {\n                  (0, _util.showModal)(\"恭喜，您已中拍！点击确定去填写订单信息吧！\");\n                }\n\n                return _context3.abrupt(\"break\", 44);\n\n              case 44:\n                console.log(msgType);\n                _context3.next = 51;\n                break;\n\n              case 47:\n                _context3.prev = 47;\n                _context3.t1 = _context3[\"catch\"](8);\n                console.error(\"处理消息出错：\");\n                console.error(_context3.t1);\n\n              case 51:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this, [[8, 47]]);\n      }));\n\n      function proccessMsg() {\n        return _proccessMsg.apply(this, arguments);\n      }\n\n      return proccessMsg;\n    }(),\n    billTap: function () {\n      var _billTap = _asyncToGenerator(\n      /*#__PURE__*/\n      _regenerator.default.mark(function _callee4(type) {\n        var action, ActiveID, Price, GUID, msgTime, SignupMsg, billMsg, tapMsg, cancelTapMsg;\n        return _regenerator.default.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                action = type;\n                ActiveID = this.ActiveID;\n                Price = this.Price;\n                _context4.next = 5;\n                return this.GUID();\n\n              case 5:\n                GUID = _context4.sent;\n                msgTime = (0, _util.formatTime)(new Date());\n                _context4.t0 = action;\n                _context4.next = _context4.t0 === \"报名\" ? 10 : _context4.t0 === \"举牌\" ? 13 : _context4.t0 === \"托管\" ? 16 : _context4.t0 === \"取消托管\" ? 19 : 22;\n                break;\n\n              case 10:\n                SignupMsg = {\n                  ActiveID: ActiveID,\n                  Shares: 1,\n                  msgID: GUID,\n                  msgType: 1,\n                  msgTime: msgTime\n                };\n                this.sendSocketMessage(SignupMsg);\n                return _context4.abrupt(\"break\", 22);\n\n              case 13:\n                billMsg = {\n                  ActiveID: ActiveID,\n                  Price: Price,\n                  msgID: GUID,\n                  msgType: 2,\n                  msgTime: msgTime\n                };\n                this.sendSocketMessage(billMsg);\n                return _context4.abrupt(\"break\", 22);\n\n              case 16:\n                tapMsg = {\n                  ActiveID: ActiveID,\n                  msgID: GUID,\n                  msgType: 4,\n                  msgTime: msgTime\n                };\n                this.sendSocketMessage(tapMsg);\n                return _context4.abrupt(\"break\", 22);\n\n              case 19:\n                cancelTapMsg = {\n                  ActiveID: ActiveID,\n                  msgID: GUID,\n                  msgType: 5,\n                  msgTime: msgTime\n                };\n                this.sendSocketMessage(cancelTapMsg);\n                return _context4.abrupt(\"break\", 22);\n\n              case 22:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function billTap(_x) {\n        return _billTap.apply(this, arguments);\n      }\n\n      return billTap;\n    }(),\n    // 下面处理倒计时的显示，实际上时间是由服务器webSocket返回的\n    seqDisplay: function seqDisplay() {\n      var seqTime = this.seqTime;\n      var date = new Date();\n      var between = seqTime - date;\n      var sec = Math.floor(between / 1000);\n      var hours = Math.floor(Math.floor(sec / 60) / 60) % 24;\n      var minutes = Math.floor(sec / 60) % 60;\n      var seconds = sec % 60;\n      var minisec = Math.floor(between / 100) % 10;\n\n      if (seconds <= 0) {\n        this.times = \"\";\n      } else {\n        if (hours < 10) {\n          hours = \"0\" + hours;\n        }\n\n        if (minutes < 10) {\n          minutes = \"0\" + minutes;\n        }\n\n        if (seconds < 10) {\n          seconds = \"0\" + seconds;\n        }\n\n        var times = hours + \":\" + minutes + \":\" + seconds + \".\" + minisec;\n        this.times = times;\n      }\n    },\n    // 倒计时\n    timerState: function timerState() {\n      var _this6 = this;\n\n      return new Promise(function (sesolve, reject) {\n        var timerState = setInterval(function () {\n          _this6.seqDisplay();\n        }, 100);\n        sesolve(timerState);\n      });\n    },\n    // 下面是生成随机GUID的函数\n    GUID: function GUID() {\n      return new Promise(function (sesolve, reject) {\n        var guid = \"\";\n\n        for (var i = 1; i <= 32; i++) {\n          var n = Math.floor(Math.random() * 16.0).toString(16);\n          guid += n;\n          if (i == 8 || i == 12 || i == 16 || i == 20) guid += \"-\";\n        }\n\n        sesolve(guid);\n      });\n    }\n  }\n});\n\nexports.default = _default;",{"version":3,"sources":["/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-3!/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--18-0!/Users/lee/Desktop/github/mall-project/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/lee/Desktop/github/mall-project/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-scoped-loader/index.js!/Users/lee/Desktop/github/mall-project/src/pages/mall/productDetailsPage/productDetailsPage.vue?vue&type=script&lang=ts&"],"names":[],"mappings":"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","sourcesContent":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from \"vue\";\nimport {\n\trequest,\n\tnavigateTo,\n\tformatTime,\n\tshowToast,\n\tshowModal\n} from \"@/common/utils/util\";\nimport {\n\tProductGet,\n\tPastTransactionsListGet,\n\tOrderDryingListGet\n} from \"@/common/config/api\";\nimport iPast from \"@/components/i-past/i-past.vue\";\nimport iShow from \"@/components/i-show/i-show.vue\";\nimport iRule from \"@/components/i-rule/i-rule.vue\";\nimport iPopup from \"@/components/i-popup/i-popup.vue\";\nlet socketOpen: boolean = false;\nlet socketMsgQueue: any = [];\nexport default Vue.extend({\n\tcomponents: {\n\t\tiPast,\n\t\tiShow,\n\t\tiRule,\n\t\tiPopup\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tindicatorDots: true,\n\t\t\tautoplay: true,\n\t\t\tinterval: 2000,\n\t\t\tduration: 500,\n\t\t\tcircular: true,\n\t\t\tindicatorActiveColor: \"#fe7f00\",\n\t\t\tdisabled: false, // 按钮disabled\n\n\t\t\tswiper: [],\n\t\t\ttitle: \"服务\",\n\t\t\tid: \"\",\n\t\t\tproduct: \"\",\n\t\t\tnum: \"9999\", // 剩余次数\n\n\t\t\ttabIndex: 0, // 默认往期成交\n\t\t\tpastList: [], // 往期成交列表\n\t\t\tshowList: [], // 晒单列表\n\t\t\truleList: \"\", // 竞拍规则\n\t\t\tshow: false, // 显示弹窗\n\n\t\t\tlabel: [\"零风险\", \"正品承诺\", \"极速发货\", \"公平公正\"],\n\t\t\ttab: [\"往期成交\", \"分享晒单\", \"竞拍规则\"],\n\t\t\tsrc: \"/static/icon_experience.png\",\n\t\t\tleading: \"/static/icon/icon_leading.png\",\n\n\t\t\tActiveID: \"\",\n\t\t\tPrice: \"\",\n\t\t\tmsgID: \"\",\n\t\t\tmsgType: \"\",\n\n\t\t\tseq: \"\", // 更新我的剩余举牌次数\n\t\t\tMyBills: \"\", // 举牌响应消息（包含我的举牌次数、剩余可用次数）\n\t\t\tUserID: \"\", // 登录成功，提示用户\n\t\t\ttapbtn: \"\", // 托管\n\t\t\tBillStat: \"\", // 总举牌次数\n\t\t\tnewprice: \"\", // 领先价格\n\t\t\tnewbill: \"\", // 领先人\n\t\t\tlastbills: [], // 出局列表\n\t\t\ttimes: \"\", // 倒计时\n\t\t\tseqTime: new Date(\"2019/7/20 10:29:35\")\n\t\t};\n\t},\n\tonLoad(options: any) {\n\t\tthis.id = options.id;\n\t\tthis.ActiveID = options.id;\n\t\tthis.UserID = uni.getStorageSync(\"SessionKey\").ID;\n\t\tthis.getProduct();\n\t\tthis.getPastTransactionsList();\n\t\tthis.getOrderDryingList();\n\t\tthis.websocket();\n\t},\n\tmethods: {\n\t\t// 获取产品详情\n\t\tgetProduct() {\n\t\t\tlet ProductID = this.id;\n\t\t\tlet data = {\n\t\t\t\tProductID: ProductID\n\t\t\t};\n\t\t\trequest(ProductGet, data).then((res: any) => {\n\t\t\t\tconsole.log(\"获取产品详情\", res);\n\t\t\t\tthis.product = res.Product;\n\t\t\t\tthis.swiper = res.Product.ProductPicList;\n\t\t\t\tthis.Price = res.Product.ProductPrice;\n\t\t\t});\n\t\t},\n\t\t// 选项卡\n\t\ttabClick(index: number) {\n\t\t\tthis.tabIndex = index;\n\t\t},\n\t\t// 往期成交列表\n\t\tgetPastTransactionsList() {\n\t\t\tlet ProductID = this.id;\n\t\t\tlet data = {\n\t\t\t\tProductID: ProductID\n\t\t\t};\n\t\t\trequest(PastTransactionsListGet, data).then((res: any) => {\n\t\t\t\tconsole.log(res);\n\t\t\t\tlet pastList = res.OrderList;\n\t\t\t\tpastList.map((item: any) => {\n\t\t\t\t\titem.percentage = (\n\t\t\t\t\t\t(item.OrderMoneys / item.OrderPrimeCost) *\n\t\t\t\t\t\t100\n\t\t\t\t\t).toFixed(2);\n\t\t\t\t});\n\t\t\t\tthis.pastList = pastList;\n\t\t\t});\n\t\t},\n\t\tchange(val: any) {\n\t\t\tconsole.log(val);\n\t\t},\n\t\thidePopup() {\n\t\t\tthis.show = !this.show;\n\t\t},\n\t\t// 获取用户晒单列表\n\t\tgetOrderDryingList() {\n\t\t\tlet ProductID = this.id;\n\t\t\tlet data = {\n\t\t\t\tProductID: ProductID\n\t\t\t};\n\t\t\trequest(OrderDryingListGet, data).then((res: any) => {\n\t\t\t\tthis.showList = res.OrderList;\n\t\t\t});\n\t\t},\n\t\tactivePath() {\n\t\t\tlet id = this.id;\n\t\t\tnavigateTo(\"../activeBilList/activeBilList?id=\" + id);\n\t\t},\n\t\tproductDetailsUparsePath() {\n\t\t\tlet id = this.id;\n\t\t\tnavigateTo(\"../productDetailsUparse/productDetailsUparse?id=\" + id);\n\t\t},\n\t\twebsocket() {\n\t\t\tuni.connectSocket({\n\t\t\t\turl: \"wss://websocket.tengpaisc.com:8888/\"\n\t\t\t});\n\t\t\tuni.onSocketOpen((res: any) => {\n\t\t\t\tconsole.log(\"WebSocket连接已打开！\");\n\t\t\t\tsocketOpen = true;\n\t\t\t\tfor (let i = 0; i < socketMsgQueue.length; i++) {\n\t\t\t\t\tthis.sendSocketMessage(socketMsgQueue[i]);\n\t\t\t\t}\n\t\t\t\tsocketMsgQueue = [];\n\t\t\t\tthis.reqLogin();\n\t\t\t\tthis.msgSubscribe();\n\t\t\t});\n\t\t\tuni.onSocketError(res => {\n\t\t\t\tconsole.log(\"WebSocket连接打开失败，请检查！\");\n\t\t\t});\n\t\t\tthis.onSocketMessage();\n\t\t},\n\t\tsendSocketMessage(msg: any) {\n\t\t\tlet data: string = JSON.stringify(msg);\n\t\t\tconsole.log(\"发送数据\", socketOpen, msg);\n\t\t\tif (socketOpen) {\n\t\t\t\tuni.sendSocketMessage({\n\t\t\t\t\tdata: data\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tsocketMsgQueue.push(msg);\n\t\t\t}\n\t\t},\n\t\tonSocketMessage() {\n\t\t\treturn new Promise((sesolve, reject) => {\n\t\t\t\tuni.onSocketMessage((res: any) => {\n\t\t\t\t\tconsole.log(\"收到服务器内容：\" + res.data);\n\t\t\t\t\tlet msg = JSON.parse(res.data);\n\t\t\t\t\tconsole.log(msg);\n\t\t\t\t\tthis.proccessMsg();\n\t\t\t\t\tsesolve(msg);\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t// 向服务器发送登录请求\n\t\tasync reqLogin() {\n\t\t\tlet GUID: any = await this.GUID();\n\t\t\tconst Appkey = \"3957399\";\n\t\t\tconst SessionKey = uni.getStorageSync(\"SessionKey\");\n\t\t\tlet ActiveID = this.ActiveID;\n\t\t\tlet UserID = this.UserID;\n\t\t\tlet ConnectionState = false;\n\t\t\tlet msgTime = formatTime(new Date());\n\t\t\tconsole.log(GUID);\n\t\t\tlet reqLogin: any = {\n\t\t\t\tActiveID: ActiveID,\n\t\t\t\tAppKey: Appkey,\n\t\t\t\tSessionKey: SessionKey,\n\t\t\t\tmsgID: GUID,\n\t\t\t\tmsgType: 3,\n\t\t\t\tmsgTime: msgTime\n\t\t\t};\n\t\t\tthis.sendSocketMessage(reqLogin);\n\t\t},\n\t\t// 发送对该活动的消息订阅\n\t\tasync msgSubscribe() {\n\t\t\tlet GUID: any = await this.GUID();\n\t\t\tlet ActiveID = this.ActiveID;\n\t\t\tlet url = \"/Actives/\" + ActiveID + \"/\";\n\t\t\tlet msgTime = formatTime(new Date());\n\t\t\tlet reqSubscribe = {\n\t\t\t\tSubscribe: url,\n\t\t\t\tmsgID: GUID,\n\t\t\t\tmsgType: 0,\n\t\t\t\tmsgTime: msgTime\n\t\t\t};\n\t\t\tthis.sendSocketMessage(reqSubscribe);\n\t\t},\n\t\t// 处理消息的函数，用于解析从服务器webSocket收到的各种消息\n\t\tasync proccessMsg() {\n\t\t\tlet msg: any = await this.onSocketMessage();\n\t\t\tlet timerState: any = await this.timerState();\n\t\t\tlet msgType = msg.msgType;\n\t\t\tthis.msgType = msgType;\n\t\t\ttry {\n\t\t\t\tswitch (msgType) {\n\t\t\t\t\tcase 0:\n\t\t\t\t\t\t// 订阅响应消息\n\t\t\t\t\t\tif (msg.IsError) {\n\t\t\t\t\t\t\tshowToast(\"订阅失败：\" + msg.ErrMsg);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tshowToast(msg.ErrMsg);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\t// 报名响应消息\n\t\t\t\t\t\tif (msg.IsError) {\n\t\t\t\t\t\t\tshowToast(\"报名失败：\" + msg.ErrMsg);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tshowToast(msg.ErrMsg);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// 更新我的剩余举牌次数\n\t\t\t\t\t\tthis.seq =\n\t\t\t\t\t\t\t\"剩余举牌次数：\" +\n\t\t\t\t\t\t\tmsg.SeqBills +\n\t\t\t\t\t\t\t\"次，已报名份数：\" +\n\t\t\t\t\t\t\tmsg.Signups +\n\t\t\t\t\t\t\t\"份，还可报名：\" +\n\t\t\t\t\t\t\tmsg.SeqSignups +\n\t\t\t\t\t\t\t\"份\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\t// 举牌响应消息（包含我的举牌次数、剩余可用次数）\n\t\t\t\t\t\tif (msg.IsError) {\n\t\t\t\t\t\t\tshowToast(msg.ErrMsg);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.MyBills =\n\t\t\t\t\t\t\t\t\"我的举牌次数：\" +\n\t\t\t\t\t\t\t\tmsg.MyBills +\n\t\t\t\t\t\t\t\t\"次，剩余可用次数：\" +\n\t\t\t\t\t\t\t\tmsg.SeqBills +\n\t\t\t\t\t\t\t\t\"次\";\n\t\t\t\t\t\t\tshowToast(msg.ErrMsg);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 3:\n\t\t\t\t\t\t// 登录响应消息\n\t\t\t\t\t\tif (msg.IsError) {\n\t\t\t\t\t\t\tshowToast(\"登录失败：\" + msg.ErrMsg);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// 登录成功，提示用户\n\t\t\t\t\t\t\tthis.UserID = msg.UserID;\n\t\t\t\t\t\t\tshowToast(msg.ErrMsg);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 4:\n\t\t\t\t\t\t// 托管响应\n\t\t\t\t\t\tif (msg.IsError) {\n\t\t\t\t\t\t\tshowToast(\"托管失败!\" + msg.ErrMsg);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.tapbtn = \"取消托管\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 5:\n\t\t\t\t\t\t// 取消托管响应消息\n\t\t\t\t\t\tif (msg.IsError) {\n\t\t\t\t\t\t\tshowToast(\"取消托管失败!\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.tapbtn = \"取消托管\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 8:\n\t\t\t\t\t\t// 价格更新通知\n\t\t\t\t\t\tshowToast(\"价格已更新......！\");\n\t\t\t\t\t\t// 更新全部举牌次数、我的举牌次数、和最新价格\n\t\t\t\t\t\tthis.BillStat = \"总举牌次数：\" + msg.AllBills + \"次\";\n\t\t\t\t\t\t// 更新最后出价人信息\n\t\t\t\t\t\tif (msg.Bills.length > 0) {\n\t\t\t\t\t\t\tthis.newprice = \"￥\" + msg.Bills[0].Price;\n\t\t\t\t\t\t\tthis.newbill = \"领先人：\" + msg.Bills[0].City;\n\t\t\t\t\t\t\t// 计算剩余时长\n\t\t\t\t\t\t\tlet dt = new Date();\n\t\t\t\t\t\t\tlet tm = dt.getTime() + msg.SeqMiniSecounds;\n\t\t\t\t\t\t\tthis.seqTime.setTime(tm);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// 更新最近出局人信息\n\t\t\t\t\t\tif (msg.Bills.length > 1) {\n\t\t\t\t\t\t\tthis.lastbills = msg.Bills;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// 判断是否需要启动计时器，如果只有一个出价，肯定就是需要启动的，因为计时器未启动\n\t\t\t\t\t\tif (msg.Bills.length === 1) {\n\t\t\t\t\t\t\tthis.timerState();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 9:\n\t\t\t\t\t\t//计算剩余时间，并重置剩余时间\n\t\t\t\t\t\tlet dt = new Date();\n\t\t\t\t\t\tlet dt_time = dt.getTime();\n\t\t\t\t\t\tthis.seqTime.setTime(dt_time + msg.SeqMiniSecounds);\n\t\t\t\t\t\tconsole.log(this.seqTime);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 10:\n\t\t\t\t\t\t// 活动正式开始，但是目前尚未有人出价，所以收到此消息，先停止计时器，并显示为 “等待先手”\n\t\t\t\t\t\tclearInterval(timerState);\n\t\t\t\t\t\tthis.times = \"等待首牌\";\n\t\t\t\t\t\tthis.newprice = \"￥\" + msg.currPrice;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 11:\n\t\t\t\t\t\t// 活动结束通知\n\t\t\t\t\t\tclearInterval(timerState);\n\t\t\t\t\t\tthis.times = \"已成交\";\n\t\t\t\t\t\t// 判断是否当前用户，如果是当前用户，则需要弹出收货地址和订单信息处理界面\n\t\t\t\t\t\tif (this.UserID === msg.WinsBill.UserID) {\n\t\t\t\t\t\t\tshowModal(\"恭喜，您已中拍！点击确定去填写订单信息吧！\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tconsole.log(msgType);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(\"处理消息出错：\");\n\t\t\t\tconsole.error(e);\n\t\t\t}\n\t\t},\n\t\tasync billTap(type: any) {\n\t\t\tlet action = type;\n\t\t\tlet ActiveID = this.ActiveID;\n\t\t\tlet Price = this.Price;\n\t\t\tlet GUID: any = await this.GUID();\n\t\t\tlet msgTime = formatTime(new Date());\n\t\t\tswitch (action) {\n\t\t\t\tcase \"报名\":\n\t\t\t\t\tvar SignupMsg = {\n\t\t\t\t\t\tActiveID: ActiveID,\n\t\t\t\t\t\tShares: 1,\n\t\t\t\t\t\tmsgID: GUID,\n\t\t\t\t\t\tmsgType: 1,\n\t\t\t\t\t\tmsgTime: msgTime\n\t\t\t\t\t};\n\t\t\t\t\tthis.sendSocketMessage(SignupMsg);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"举牌\":\n\t\t\t\t\tvar billMsg = {\n\t\t\t\t\t\tActiveID: ActiveID,\n\t\t\t\t\t\tPrice: Price,\n\t\t\t\t\t\tmsgID: GUID,\n\t\t\t\t\t\tmsgType: 2,\n\t\t\t\t\t\tmsgTime: msgTime\n\t\t\t\t\t};\n\t\t\t\t\tthis.sendSocketMessage(billMsg);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"托管\":\n\t\t\t\t\tvar tapMsg = {\n\t\t\t\t\t\tActiveID: ActiveID,\n\t\t\t\t\t\tmsgID: GUID,\n\t\t\t\t\t\tmsgType: 4,\n\t\t\t\t\t\tmsgTime: msgTime\n\t\t\t\t\t};\n\t\t\t\t\tthis.sendSocketMessage(tapMsg);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"取消托管\":\n\t\t\t\t\tvar cancelTapMsg = {\n\t\t\t\t\t\tActiveID: ActiveID,\n\t\t\t\t\t\tmsgID: GUID,\n\t\t\t\t\t\tmsgType: 5,\n\t\t\t\t\t\tmsgTime: msgTime\n\t\t\t\t\t};\n\t\t\t\t\tthis.sendSocketMessage(cancelTapMsg);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\t\t// 下面处理倒计时的显示，实际上时间是由服务器webSocket返回的\n\t\tseqDisplay() {\n\t\t\tlet seqTime: any = this.seqTime;\n\t\t\tlet date: any = new Date();\n\t\t\tlet between: number = seqTime - date;\n\t\t\tlet sec: number = Math.floor(between / 1000);\n\t\t\tlet hours: any = Math.floor(Math.floor(sec / 60) / 60) % 24;\n\t\t\tlet minutes: any = Math.floor(sec / 60) % 60;\n\t\t\tlet seconds: any = sec % 60;\n\t\t\tlet minisec: number = Math.floor(between / 100) % 10;\n\t\t\tif (seconds <= 0) {\n\t\t\t\tthis.times = \"\";\n\t\t\t} else {\n\t\t\t\tif (hours < 10) {\n\t\t\t\t\thours = \"0\" + hours;\n\t\t\t\t}\n\t\t\t\tif (minutes < 10) {\n\t\t\t\t\tminutes = \"0\" + minutes;\n\t\t\t\t}\n\t\t\t\tif (seconds < 10) {\n\t\t\t\t\tseconds = \"0\" + seconds;\n\t\t\t\t}\n\t\t\t\tlet times = hours + \":\" + minutes + \":\" + seconds + \".\" + minisec;\n\t\t\t\tthis.times = times;\n\t\t\t}\n\t\t},\n\t\t// 倒计时\n\t\ttimerState() {\n\t\t\treturn new Promise((sesolve, reject) => {\n\t\t\t\tlet timerState = setInterval(() => {\n\t\t\t\t\tthis.seqDisplay();\n\t\t\t\t}, 100);\n\t\t\t\tsesolve(timerState);\n\t\t\t});\n\t\t},\n\t\t// 下面是生成随机GUID的函数\n\t\tGUID() {\n\t\t\treturn new Promise((sesolve, reject) => {\n\t\t\t\tlet guid = \"\";\n\t\t\t\tfor (let i = 1; i <= 32; i++) {\n\t\t\t\t\tlet n = Math.floor(Math.random() * 16.0).toString(16);\n\t\t\t\t\tguid += n;\n\t\t\t\t\tif (i == 8 || i == 12 || i == 16 || i == 20) guid += \"-\";\n\t\t\t\t}\n\t\t\t\tsesolve(guid);\n\t\t\t});\n\t\t}\n\t}\n});\n"],"sourceRoot":""}]}