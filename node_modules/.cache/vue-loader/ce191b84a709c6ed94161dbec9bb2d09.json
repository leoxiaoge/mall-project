{"remainingRequest":"/Users/lee/Desktop/github/mall-project/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-scoped-loader/index.js!/Users/lee/Desktop/github/mall-project/src/pages/ucenter/login/login.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/lee/Desktop/github/mall-project/src/pages/ucenter/login/login.vue","mtime":1569817525027},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/cache-loader/dist/cjs.js","mtime":1554990705312},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js","mtime":1560261191357},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/ts-loader/index.js","mtime":1560261210667},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js","mtime":1563798331564},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js","mtime":1563798331564},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/cache-loader/dist/cjs.js","mtime":1554990705312},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/vue-loader/lib/index.js","mtime":1563798333387},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-scoped-loader/index.js","mtime":1563798331564}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from \"vue\";\nimport { mapState, mapMutations } from \"vuex\";\nimport {\n\trequest,\n\tnavigateTo,\n\tnavigateBack,\n\tshowToast,\n\tonShareAppMessage\n} from \"@/common/utils/util\";\nimport { UserLogin, GetLoginCode, GetWXOpenID } from \"@/common/config/api\";\nimport uniIcon from \"@/components/uni-icon/uni-icon.vue\";\nexport default Vue.extend({\n\tcomponents: {\n\t\tuniIcon\n\t},\n\tcomputed: {\n\t\t...mapState([\"hasLogin\"])\n\t},\n\tdata() {\n\t\treturn {\n\t\t\twxFace: \"\",\n\t\t\twxNick: \"\",\n\t\t\trefUserID: \"\",\n\t\t\tlogo: \"/static/icon/icon_login.png\",\n\t\t\tchecked: true,\n\t\t\tcolor: \"#fe7f00\",\n\t\t\tfocus: true,\n\t\t\tMobile: \"\",\n\t\t\tLoginCode: \"\",\n\t\t\tloading: false,\n\t\t\ttime: \"获取验证码\",\n\t\t\tcurrentTime: 60,\n\t\t\tdisabled: false,\n\t\t\tinterval: \"\"\n\t\t};\n\t},\n\tonLoad(options: any) {},\n\tonUnload() {\n\t\tlet interval: any = this.interval;\n\t\tclearInterval(interval);\n\t},\n\tonShareAppMessage(e: any) {\n\t\treturn onShareAppMessage(e);\n\t},\n\tmethods: {\n\t\t...mapMutations([\"login\"]),\n\t\tgetProvider() {\n\t\t\treturn new Promise((sesolve, reject) => {\n\t\t\t\tuni.getProvider({\n\t\t\t\t\tservice: \"oauth\",\n\t\t\t\t\tsuccess: (res: any) => {\n\t\t\t\t\t\tsesolve(res.provider);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tasync login() {\n\t\t\tlet provider: any = await this.getProvider();\n\t\t\treturn new Promise((sesolve, reject) => {\n\t\t\t\tif (~provider.indexOf(\"weixin\")) {\n\t\t\t\t\tuni.login({\n\t\t\t\t\t\tprovider: \"weixin\",\n\t\t\t\t\t\tsuccess: (loginRes: any) => {\n\t\t\t\t\t\t\tlet JSCode = loginRes.code;\n\t\t\t\t\t\t\tconsole.log(JSCode);\n\t\t\t\t\t\t\tlet data = {\n\t\t\t\t\t\t\t\tJSCode: JSCode\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\trequest(GetWXOpenID, data).then((res: any) => {\n\t\t\t\t\t\t\t\tsesolve(res.OpenID);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tmobileInput(e: any) {\n\t\t\tthis.Mobile = e.detail.value;\n\t\t},\n\t\tcodeInput(e: any) {\n\t\t\tthis.LoginCode = e.detail.value;\n\t\t},\n\t\tgetCode(e: any) {\n\t\t\tlet Mobile = this.Mobile;\n\t\t\tif (!Mobile) {\n\t\t\t\tshowToast(\"手机号码不能为空！\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.getLoginCode();\n\t\t\tlet currentTime: any = this.currentTime;\n\t\t\tthis.time = currentTime + \"s后可重发\";\n\t\t\tthis.disabled = true;\n\t\t\tlet interval: any = setInterval(() => {\n\t\t\t\tthis.time = currentTime - 1 + \"s后可重发\";\n\t\t\t\tcurrentTime--;\n\t\t\t\tif (currentTime <= 0) {\n\t\t\t\t\tclearInterval(interval);\n\t\t\t\t\tthis.time = \"重新获取\";\n\t\t\t\t\tthis.currentTime = 60;\n\t\t\t\t\tthis.disabled = false;\n\t\t\t\t}\n\t\t\t}, 1000);\n\t\t\tthis.interval = interval;\n\t\t},\n\t\tgetLoginCode() {\n\t\t\tlet Mobile = this.Mobile;\n\t\t\tlet data = {\n\t\t\t\tMobile: Mobile\n\t\t\t};\n\t\t\trequest(GetLoginCode, data).then((res: any) => {\n\t\t\t\tconsole.log(res);\n\t\t\t\tshowToast(\"发送成功！\");\n\t\t\t});\n\t\t},\n\t\tradioClick() {\n\t\t\tthis.checked = !this.checked;\n\t\t},\n\t\tasync wxLogin(e: any) {\n\t\t\tconsole.log(e);\n\t\t\tlet userInfo = e.detail.userInfo;\n\t\t\tthis.wxFace = userInfo.avatarUrl;\n\t\t\tthis.wxNick = userInfo.nickName;\n\t\t\tlet OpenID: any = await this.login();\n\t\t\tuni.setStorageSync(\"OpenID\", OpenID);\n\t\t\tthis.userLogin();\n\t\t},\n\t\tasync userLogin() {\n\t\t\tlet Mobile = this.Mobile;\n\t\t\tlet LoginCode = this.LoginCode;\n\t\t\tlet wxFace = this.wxFace;\n\t\t\tlet wxNick = encodeURIComponent(this.wxNick);\n\t\t\tlet refUserID = this.refUserID;\n\t\t\tif (uni.getStorageSync(\"scene\")) {\n\t\t\t\trefUserID = uni.getStorageSync(\"scene\");\n\t\t\t}\n\t\t\tif (!Mobile) {\n\t\t\t\tshowToast(\"手机号码不能为空！\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (!LoginCode) {\n\t\t\t\tshowToast(\"验证码不能为空！\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.loading = true;\n\t\t\t// #ifdef MP-WEIXIN\n\t\t\tlet OpenID: any = await this.login();\n\t\t\t// #endif\n\t\t\tlet data = {\n\t\t\t\tMobile: Mobile,\n\t\t\t\tLoginCode: LoginCode,\n\t\t\t\t// #ifdef MP-WEIXIN\n\t\t\t\tOpenID: OpenID,\n\t\t\t\t// #endif\n\t\t\t\twxFace: wxFace,\n\t\t\t\twxNick: wxNick,\n\t\t\t\tRefUserID: refUserID\n\t\t\t};\n\t\t\trequest(UserLogin, data).then((res: any) => {\n\t\t\t\tthis.loading = false;\n\t\t\t\tlet SessionKey = res.SessionKey;\n\t\t\t\tlet UserInfo = res.UserInfo;\n\t\t\t\tuni.setStorageSync(\"SessionKey\", SessionKey);\n\t\t\t\tuni.setStorageSync(\"UserInfo\", UserInfo);\n\t\t\t\tshowToast(\"登录成功！\");\n\t\t\t\tnavigateBack(1);\n\t\t\t});\n\t\t},\n\t\tgetuserinfo(e: any) {\n\t\t\tconsole.log(e);\n\t\t},\n\t\tprotocol() {\n\t\t\tnavigateTo(\"../protocol/protocol\");\n\t\t}\n\t}\n});\n",{"version":3,"sources":["login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"login.vue","sourceRoot":"src/pages/ucenter/login","sourcesContent":["\n<template>\n\t<view class=\"container\">\n\t\t<view class=\"i-header-logo\">\n\t\t\t<image :src=\"logo\" />\n\t\t</view>\n\t\t<view class=\"i-login-mobile i-border-bottom i-flex-between\">\n\t\t\t<view class=\"i-login-content i-flex\">\n\t\t\t\t<image class=\"i-login-mobile-image\" />\n\t\t\t\t<input\n\t\t\t\t\tclass=\"i-login-mobile-input\"\n\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t:focus=\"focus\"\n\t\t\t\t\t:value=\"Mobile\"\n\t\t\t\t\tplaceholder=\"请输入手机号码\"\n\t\t\t\t\t@input=\"mobileInput\"\n\t\t\t\t/>\n\t\t\t</view>\n\t\t\t<view class=\"i-login-set-code\">\n\t\t\t\t<button class=\"i-button-get\" :disabled=\"disabled\" @click=\"getCode\">{{time}}</button>\n\t\t\t</view>\n\t\t</view>\n\t\t<view class=\"i-login-code i-border-bottom\">\n\t\t\t<view class=\"i-login-content i-flex\">\n\t\t\t\t<image class=\"i-login-code-image\" />\n\t\t\t\t<input\n\t\t\t\t\tclass=\"i-login-code-input\"\n\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t:value=\"LoginCode\"\n\t\t\t\t\tplaceholder=\"验证码\"\n\t\t\t\t\t@input=\"codeInput\"\n\t\t\t\t/>\n\t\t\t</view>\n\t\t</view>\n\t\t<view class=\"i-login-radio\">\n\t\t\t<radio-group name=\"radio\">\n\t\t\t\t<label class=\"radio\">\n\t\t\t\t\t<radio @click.stop.prevent=\"radioClick\" :checked=\"checked\" :color=\"color\" />\n\t\t\t\t</label>\n\t\t\t\t<text class=\"protocol-agree\">我已阅读并同意</text>\n\t\t\t\t<text class=\"protocol-text\" @click=\"protocol\">《腾拍商场购物协议》</text>\n\t\t\t</radio-group>\n\t\t</view>\n\t\t<view class=\"i-login-button-view\">\n\t\t\t<!-- #ifdef MP-WEIXIN -->\n\t\t\t<button\n\t\t\t\tclass=\"btn i-login-button\"\n\t\t\t\t:loading=\"loading\"\n\t\t\t\t:disabled=\"!checked\"\n\t\t\t\topen-type=\"getUserInfo\"\n\t\t\t\t@getuserinfo=\"wxLogin\"\n\t\t\t>登录</button>\n\t\t\t<!-- #endif -->\n\t\t\t<!-- #ifndef MP-WEIXIN -->\n\t\t\t<button class=\"btn i-login-button\" :loading=\"loading\" :disabled=\"!checked\" @click=\"userLogin\">登录</button>\n\t\t\t<!-- #endif -->\n\t\t</view>\n\t</view>\n</template>\n\n<script lang=\"ts\">\nimport Vue from \"vue\";\nimport { mapState, mapMutations } from \"vuex\";\nimport {\n\trequest,\n\tnavigateTo,\n\tnavigateBack,\n\tshowToast,\n\tonShareAppMessage\n} from \"@/common/utils/util\";\nimport { UserLogin, GetLoginCode, GetWXOpenID } from \"@/common/config/api\";\nimport uniIcon from \"@/components/uni-icon/uni-icon.vue\";\nexport default Vue.extend({\n\tcomponents: {\n\t\tuniIcon\n\t},\n\tcomputed: {\n\t\t...mapState([\"hasLogin\"])\n\t},\n\tdata() {\n\t\treturn {\n\t\t\twxFace: \"\",\n\t\t\twxNick: \"\",\n\t\t\trefUserID: \"\",\n\t\t\tlogo: \"/static/icon/icon_login.png\",\n\t\t\tchecked: true,\n\t\t\tcolor: \"#fe7f00\",\n\t\t\tfocus: true,\n\t\t\tMobile: \"\",\n\t\t\tLoginCode: \"\",\n\t\t\tloading: false,\n\t\t\ttime: \"获取验证码\",\n\t\t\tcurrentTime: 60,\n\t\t\tdisabled: false,\n\t\t\tinterval: \"\"\n\t\t};\n\t},\n\tonLoad(options: any) {},\n\tonUnload() {\n\t\tlet interval: any = this.interval;\n\t\tclearInterval(interval);\n\t},\n\tonShareAppMessage(e: any) {\n\t\treturn onShareAppMessage(e);\n\t},\n\tmethods: {\n\t\t...mapMutations([\"login\"]),\n\t\tgetProvider() {\n\t\t\treturn new Promise((sesolve, reject) => {\n\t\t\t\tuni.getProvider({\n\t\t\t\t\tservice: \"oauth\",\n\t\t\t\t\tsuccess: (res: any) => {\n\t\t\t\t\t\tsesolve(res.provider);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tasync login() {\n\t\t\tlet provider: any = await this.getProvider();\n\t\t\treturn new Promise((sesolve, reject) => {\n\t\t\t\tif (~provider.indexOf(\"weixin\")) {\n\t\t\t\t\tuni.login({\n\t\t\t\t\t\tprovider: \"weixin\",\n\t\t\t\t\t\tsuccess: (loginRes: any) => {\n\t\t\t\t\t\t\tlet JSCode = loginRes.code;\n\t\t\t\t\t\t\tconsole.log(JSCode);\n\t\t\t\t\t\t\tlet data = {\n\t\t\t\t\t\t\t\tJSCode: JSCode\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\trequest(GetWXOpenID, data).then((res: any) => {\n\t\t\t\t\t\t\t\tsesolve(res.OpenID);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tmobileInput(e: any) {\n\t\t\tthis.Mobile = e.detail.value;\n\t\t},\n\t\tcodeInput(e: any) {\n\t\t\tthis.LoginCode = e.detail.value;\n\t\t},\n\t\tgetCode(e: any) {\n\t\t\tlet Mobile = this.Mobile;\n\t\t\tif (!Mobile) {\n\t\t\t\tshowToast(\"手机号码不能为空！\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.getLoginCode();\n\t\t\tlet currentTime: any = this.currentTime;\n\t\t\tthis.time = currentTime + \"s后可重发\";\n\t\t\tthis.disabled = true;\n\t\t\tlet interval: any = setInterval(() => {\n\t\t\t\tthis.time = currentTime - 1 + \"s后可重发\";\n\t\t\t\tcurrentTime--;\n\t\t\t\tif (currentTime <= 0) {\n\t\t\t\t\tclearInterval(interval);\n\t\t\t\t\tthis.time = \"重新获取\";\n\t\t\t\t\tthis.currentTime = 60;\n\t\t\t\t\tthis.disabled = false;\n\t\t\t\t}\n\t\t\t}, 1000);\n\t\t\tthis.interval = interval;\n\t\t},\n\t\tgetLoginCode() {\n\t\t\tlet Mobile = this.Mobile;\n\t\t\tlet data = {\n\t\t\t\tMobile: Mobile\n\t\t\t};\n\t\t\trequest(GetLoginCode, data).then((res: any) => {\n\t\t\t\tconsole.log(res);\n\t\t\t\tshowToast(\"发送成功！\");\n\t\t\t});\n\t\t},\n\t\tradioClick() {\n\t\t\tthis.checked = !this.checked;\n\t\t},\n\t\tasync wxLogin(e: any) {\n\t\t\tconsole.log(e);\n\t\t\tlet userInfo = e.detail.userInfo;\n\t\t\tthis.wxFace = userInfo.avatarUrl;\n\t\t\tthis.wxNick = userInfo.nickName;\n\t\t\tlet OpenID: any = await this.login();\n\t\t\tuni.setStorageSync(\"OpenID\", OpenID);\n\t\t\tthis.userLogin();\n\t\t},\n\t\tasync userLogin() {\n\t\t\tlet Mobile = this.Mobile;\n\t\t\tlet LoginCode = this.LoginCode;\n\t\t\tlet wxFace = this.wxFace;\n\t\t\tlet wxNick = encodeURIComponent(this.wxNick);\n\t\t\tlet refUserID = this.refUserID;\n\t\t\tif (uni.getStorageSync(\"scene\")) {\n\t\t\t\trefUserID = uni.getStorageSync(\"scene\");\n\t\t\t}\n\t\t\tif (!Mobile) {\n\t\t\t\tshowToast(\"手机号码不能为空！\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (!LoginCode) {\n\t\t\t\tshowToast(\"验证码不能为空！\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.loading = true;\n\t\t\t// #ifdef MP-WEIXIN\n\t\t\tlet OpenID: any = await this.login();\n\t\t\t// #endif\n\t\t\tlet data = {\n\t\t\t\tMobile: Mobile,\n\t\t\t\tLoginCode: LoginCode,\n\t\t\t\t// #ifdef MP-WEIXIN\n\t\t\t\tOpenID: OpenID,\n\t\t\t\t// #endif\n\t\t\t\twxFace: wxFace,\n\t\t\t\twxNick: wxNick,\n\t\t\t\tRefUserID: refUserID\n\t\t\t};\n\t\t\trequest(UserLogin, data).then((res: any) => {\n\t\t\t\tthis.loading = false;\n\t\t\t\tlet SessionKey = res.SessionKey;\n\t\t\t\tlet UserInfo = res.UserInfo;\n\t\t\t\tuni.setStorageSync(\"SessionKey\", SessionKey);\n\t\t\t\tuni.setStorageSync(\"UserInfo\", UserInfo);\n\t\t\t\tshowToast(\"登录成功！\");\n\t\t\t\tnavigateBack(1);\n\t\t\t});\n\t\t},\n\t\tgetuserinfo(e: any) {\n\t\t\tconsole.log(e);\n\t\t},\n\t\tprotocol() {\n\t\t\tnavigateTo(\"../protocol/protocol\");\n\t\t}\n\t}\n});\n</script>\n\n<style scoped>\npage {\n\tbackground-color: #fff;\n}\n\n.i-header-logo {\n\tpadding: 80upx 0 80upx 0;\n\ttext-align: center;\n}\n\n.i-header-logo image {\n\twidth: 180upx;\n\theight: 180upx;\n}\n\n.i-border-bottom {\n\tborder-bottom: 2upx solid #f4f4f4;\n}\n\n.i-login-mobile {\n\tmargin: 0 60upx;\n\tpadding: 20upx 0;\n}\n\n.i-login-code {\n\tmargin: 0 60upx;\n\tpadding: 20upx 0;\n}\n\n.i-login-mobile-image {\n\tbackground: url(https://api.tengpaisc.com/Resources/images/icon_login_mobile.png)\n\t\tcenter no-repeat;\n\tbackground-size: 100%;\n\twidth: 36upx;\n\theight: 52upx;\n}\n\n.i-login-code-image {\n\tbackground: url(https://api.tengpaisc.com/Resources/images/icon_login_code.png)\n\t\tcenter no-repeat;\n\tbackground-size: 100%;\n\twidth: 36upx;\n\theight: 52upx;\n}\n\n.i-login-mobile-input {\n\tmargin-left: 20upx;\n}\n\n.i-login-code-input {\n\tmargin-left: 20upx;\n}\n\n.i-login-radio {\n\tmargin: 0 60upx;\n\tpadding: 20upx 0;\n}\n\n.radio {\n\tpadding: 0;\n}\n\n.protocol-agree {\n  margin-left: 10upx;\n}\n\n.protocol-text {\n\tcolor: #fe7f00;\n}\n\n.i-button-get {\n\tbackground-color: #fff;\n\tfont-size: 32upx;\n\tcolor: #fe7f00;\n}\n\nbutton:after {\n\tcontent: \" \";\n\twidth: 200%;\n\theight: 200%;\n\tposition: absolute;\n\ttop: 0;\n\tleft: 0;\n\tborder: none;\n\t-webkit-transform: scale(0.5);\n\ttransform: scale(0.5);\n\t-webkit-transform-origin: 0 0;\n\ttransform-origin: 0 0;\n\tbox-sizing: border-box;\n\tborder-radius: 10px;\n}\n\nbutton[disabled]:not([type]),\nbutton[disabled][type=\"default\"] {\n\tcolor: rgba(0, 0, 0, 0.3);\n\tbackground-color: #f4f4f4;\n}\n\n.i-login-button {\n\tfont-size: 32upx;\n\tline-height: 80upx;\n\twidth: 80%;\n\tcolor: #fff;\n\tbackground-color: #fe7f00;\n\tborder-radius: 100upx;\n\tmargin-top: 40upx;\n}\n</style>\n"]}]}