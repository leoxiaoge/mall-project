{"remainingRequest":"/Users/lee/Desktop/github/mall-project/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-scoped-loader/index.js!/Users/lee/Desktop/github/mall-project/src/pages/ucenter/setting/setting.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/lee/Desktop/github/mall-project/src/pages/ucenter/setting/setting.vue","mtime":1566834902918},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/cache-loader/dist/cjs.js","mtime":1554990705312},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/babel-loader/lib/index.js","mtime":1560261191357},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/ts-loader/index.js","mtime":1560261210667},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js","mtime":1563798331564},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js","mtime":1563798331564},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/cache-loader/dist/cjs.js","mtime":1554990705312},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/vue-loader/lib/index.js","mtime":1563798333387},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-scoped-loader/index.js","mtime":1563798331564}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from \"vue\";\nimport {\n\trequest,\n\tnavigateTo,\n\tshowToast,\n\tdefaultShowModal,\n\tupload,\n\tpreviewImage,\n\tonShareAppMessage\n} from \"@/common/utils/util\";\nimport {\n\tGetLoginUser,\n\tUpdateUserInfo,\n\tOrderDryingUpload\n} from \"@/common/config/api\";\nimport uniIcon from \"@/components/uni-icon/uni-icon.vue\";\nimport iPopupToggle from \"@/components/i-popup-toggle/i-popup-toggle.vue\";\nexport default Vue.extend({\n\tcomponents: {\n\t\tuniIcon,\n\t\tiPopupToggle\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tuserInfo: \"\",\n\t\t\tuserNick: \"\",\n\t\t\tuserFace: \"\",\n\t\t\tshowPopup: false\n\t\t};\n\t},\n\tonLoad(options) {\n\t\tconsole.log(\"onLoad\", options);\n\t},\n\tonShow() {\n\t\tthis.useInfo();\n\t},\n\tonShareAppMessage(e: any) {\n\t\treturn onShareAppMessage(e);\n\t},\n\tmethods: {\n\t\tasync useInfo() {\n\t\t\tlet userInfo: any = await this.getLoginUser();\n\t\t\tthis.userInfo = userInfo;\n\t\t\tthis.userFace = userInfo.userFace;\n\t\t\tthis.userNick = decodeURIComponent(userInfo.userNick);\n\t\t},\n\t\t// 获取当前登录用户的信息\n\t\tgetLoginUser() {\n\t\t\treturn new Promise((sesolve, reject) => {\n\t\t\t\tlet data = {};\n\t\t\t\trequest(GetLoginUser, data).then((res: any) => {\n\t\t\t\t\tuni.setStorageSync(\"UserInfo\", res.UserInfo);\n\t\t\t\t\tsesolve(res.UserInfo);\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tuserFaceClick() {\n\t\t\tthis.showPopup = !this.showPopup;\n\t\t},\n\t\ttogglePopup() {\n\t\t\tthis.showPopup = !this.showPopup;\n\t\t},\n\t\tpreview(current: any, urls: any) {\n\t\t\turls = [urls];\n\t\t\tpreviewImage(current, urls);\n\t\t},\n\t\tchooseImageCamera() {\n\t\t\tuni.chooseImage({\n\t\t\t\tcount: 1,\n\t\t\t\tsizeType: [\"original\", \"compressed\"], // 可以指定是原图还是压缩图，默认二者都有\n\t\t\t\tsourceType: [\"camera\"], // 使用相机\n\t\t\t\tsuccess: (res: any) => {\n\t\t\t\t\tlet filePath = JSON.stringify(res.tempFilePaths[0]);\n\t\t\t\t\tthis.uploadImage(filePath);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tchooseImageAlbum() {\n\t\t\tuni.chooseImage({\n\t\t\t\tcount: 1,\n\t\t\t\tsizeType: [\"original\", \"compressed\"], // 可以指定是原图还是压缩图，默认二者都有\n\t\t\t\tsourceType: [\"album\"], // 从相册选择\n\t\t\t\tsuccess: (res: any) => {\n\t\t\t\t\tlet filePath = JSON.stringify(res.tempFilePaths[0]);\n\t\t\t\t\tthis.uploadImage(filePath);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tuploadImage(filePath: any) {\n\t\t\tlet data = {};\n\t\t\tupload(OrderDryingUpload, data, filePath).then((res: any) => {\n\t\t\t\tlet data = JSON.parse(res);\n\t\t\t\tlet picUrl = data.PicUrl;\n\t\t\t\tthis.updateUserInfo(picUrl);\n\t\t\t});\n\t\t},\n\t\tupdateUserInfo(event: any) {\n\t\t\tlet UserFace = event;\n\t\t\tlet data = {\n\t\t\t\tUserFace: UserFace\n\t\t\t};\n\t\t\trequest(UpdateUserInfo, data).then((res: any) => {\n        showToast(\"更换头像成功！\");\n        this.showPopup = !this.showPopup;\n\t\t\t});\n\t\t},\n\t\tuserNickClick() {\n\t\t\tnavigateTo(\"../settingUserNick/settingUserNick\");\n\t\t},\n\t\tclear() {\n\t\t\tlet content: string = \"是否确定退出登录？\";\n\t\t\tdefaultShowModal(content).then((res: any) => {\n\t\t\t\tif (res.confirm) {\n\t\t\t\t\tconsole.log(\"用户点击确定\");\n\t\t\t\t\ttry {\n\t\t\t\t\t\tuni.clearStorageSync();\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tshowToast(\"退出登录失败\");\n\t\t\t\t\t}\n\t\t\t\t} else if (res.cancel) {\n\t\t\t\t\tconsole.log(\"用户点击取消\");\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n});\n",{"version":3,"sources":["setting.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"setting.vue","sourceRoot":"src/pages/ucenter/setting","sourcesContent":["<template>\n\t<view class=\"content\">\n\t\t<view class=\"list-item userFace\" @click=\"userFaceClick\">\n\t\t\t<view class=\"list-item-user\">头像</view>\n\t\t\t<view class=\"list-item-face\">\n\t\t\t\t<image :src=\"userFace\" />\n\t\t\t\t<uni-icon :size=\"20\" color=\"#bbb\" type=\"arrowright\" />\n\t\t\t</view>\n\t\t</view>\n\t\t<view class=\"list-item userNick\" @click=\"userNickClick\">\n\t\t\t<view class=\"list-item-user\">昵称</view>\n\t\t\t<view class=\"list-item-nick\">\n\t\t\t\t<text>{{userNick}}</text>\n\t\t\t\t<uni-icon :size=\"20\" color=\"#bbb\" type=\"arrowright\" />\n\t\t\t</view>\n\t\t</view>\n\t\t<view class=\"sign-out\">\n\t\t\t<button class=\"signBtn\" @click=\"clear\">退出登录</button>\n\t\t</view>\n\t\t<i-popup-toggle :show=\"showPopup\" position=\"bottom\" @hidePopup=\"togglePopup('')\">\n\t\t\t<view class=\"popup-bottom\">\n\t\t\t\t<view class=\"popup-bottom-content\">\n\t\t\t\t\t<button class=\"previewImageFull\" @click=\"preview(userFace, userFace)\">查看大图</button>\n\t\t\t\t\t<button class=\"chooseImageCamera\" @click=\"chooseImageCamera\">拍照换头像</button>\n\t\t\t\t\t<button class=\"chooseImageAlbum\" @click=\"chooseImageAlbum\">从相册选择新头像</button>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"cancel\">\n\t\t\t\t\t<button @click=\"userFaceClick\">取消</button>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</i-popup-toggle>\n\t</view>\n</template>\n\n<script lang=\"ts\">\nimport Vue from \"vue\";\nimport {\n\trequest,\n\tnavigateTo,\n\tshowToast,\n\tdefaultShowModal,\n\tupload,\n\tpreviewImage,\n\tonShareAppMessage\n} from \"@/common/utils/util\";\nimport {\n\tGetLoginUser,\n\tUpdateUserInfo,\n\tOrderDryingUpload\n} from \"@/common/config/api\";\nimport uniIcon from \"@/components/uni-icon/uni-icon.vue\";\nimport iPopupToggle from \"@/components/i-popup-toggle/i-popup-toggle.vue\";\nexport default Vue.extend({\n\tcomponents: {\n\t\tuniIcon,\n\t\tiPopupToggle\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tuserInfo: \"\",\n\t\t\tuserNick: \"\",\n\t\t\tuserFace: \"\",\n\t\t\tshowPopup: false\n\t\t};\n\t},\n\tonLoad(options) {\n\t\tconsole.log(\"onLoad\", options);\n\t},\n\tonShow() {\n\t\tthis.useInfo();\n\t},\n\tonShareAppMessage(e: any) {\n\t\treturn onShareAppMessage(e);\n\t},\n\tmethods: {\n\t\tasync useInfo() {\n\t\t\tlet userInfo: any = await this.getLoginUser();\n\t\t\tthis.userInfo = userInfo;\n\t\t\tthis.userFace = userInfo.userFace;\n\t\t\tthis.userNick = decodeURIComponent(userInfo.userNick);\n\t\t},\n\t\t// 获取当前登录用户的信息\n\t\tgetLoginUser() {\n\t\t\treturn new Promise((sesolve, reject) => {\n\t\t\t\tlet data = {};\n\t\t\t\trequest(GetLoginUser, data).then((res: any) => {\n\t\t\t\t\tuni.setStorageSync(\"UserInfo\", res.UserInfo);\n\t\t\t\t\tsesolve(res.UserInfo);\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tuserFaceClick() {\n\t\t\tthis.showPopup = !this.showPopup;\n\t\t},\n\t\ttogglePopup() {\n\t\t\tthis.showPopup = !this.showPopup;\n\t\t},\n\t\tpreview(current: any, urls: any) {\n\t\t\turls = [urls];\n\t\t\tpreviewImage(current, urls);\n\t\t},\n\t\tchooseImageCamera() {\n\t\t\tuni.chooseImage({\n\t\t\t\tcount: 1,\n\t\t\t\tsizeType: [\"original\", \"compressed\"], // 可以指定是原图还是压缩图，默认二者都有\n\t\t\t\tsourceType: [\"camera\"], // 使用相机\n\t\t\t\tsuccess: (res: any) => {\n\t\t\t\t\tlet filePath = JSON.stringify(res.tempFilePaths[0]);\n\t\t\t\t\tthis.uploadImage(filePath);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tchooseImageAlbum() {\n\t\t\tuni.chooseImage({\n\t\t\t\tcount: 1,\n\t\t\t\tsizeType: [\"original\", \"compressed\"], // 可以指定是原图还是压缩图，默认二者都有\n\t\t\t\tsourceType: [\"album\"], // 从相册选择\n\t\t\t\tsuccess: (res: any) => {\n\t\t\t\t\tlet filePath = JSON.stringify(res.tempFilePaths[0]);\n\t\t\t\t\tthis.uploadImage(filePath);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tuploadImage(filePath: any) {\n\t\t\tlet data = {};\n\t\t\tupload(OrderDryingUpload, data, filePath).then((res: any) => {\n\t\t\t\tlet data = JSON.parse(res);\n\t\t\t\tlet picUrl = data.PicUrl;\n\t\t\t\tthis.updateUserInfo(picUrl);\n\t\t\t});\n\t\t},\n\t\tupdateUserInfo(event: any) {\n\t\t\tlet UserFace = event;\n\t\t\tlet data = {\n\t\t\t\tUserFace: UserFace\n\t\t\t};\n\t\t\trequest(UpdateUserInfo, data).then((res: any) => {\n        showToast(\"更换头像成功！\");\n        this.showPopup = !this.showPopup;\n\t\t\t});\n\t\t},\n\t\tuserNickClick() {\n\t\t\tnavigateTo(\"../settingUserNick/settingUserNick\");\n\t\t},\n\t\tclear() {\n\t\t\tlet content: string = \"是否确定退出登录？\";\n\t\t\tdefaultShowModal(content).then((res: any) => {\n\t\t\t\tif (res.confirm) {\n\t\t\t\t\tconsole.log(\"用户点击确定\");\n\t\t\t\t\ttry {\n\t\t\t\t\t\tuni.clearStorageSync();\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tshowToast(\"退出登录失败\");\n\t\t\t\t\t}\n\t\t\t\t} else if (res.cancel) {\n\t\t\t\t\tconsole.log(\"用户点击取消\");\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n});\n</script>\n\n<style scoped>\n.list-item {\n\tdisplay: flex;\n\tjustify-content: space-between;\n\talign-items: center;\n\tpadding: 10upx 30upx;\n\tbackground-color: #fff;\n}\n\n.userFace {\n\theight: 180upx;\n\tborder-bottom: 2upx solid #f4f4f4;\n}\n\n.userNick {\n\theight: 100upx;\n}\n\n.list-item-face {\n\tdisplay: flex;\n\tjustify-content: flex-end;\n\talign-items: center;\n}\n\n.list-item-face image {\n\twidth: 120upx;\n\theight: 120upx;\n\tborder-radius: 50%;\n}\n\n.sign-out {\n\tmargin-top: 20upx;\n}\n\n.signBtn {\n  color: #7a7a7a;\n  background-color: #fff;\n}\n\n.popup-bottom {\n\twidth: 90%;\n\topacity: .9;\n}\n\n.popup-bottom button {\n\tcolor: #7a7a7a;\n}\n\n.previewImageFull {\n  border-top-left-radius: 10upx;\n  border-top-right-radius: 10upx;\n}\n\n.chooseImageAlbum {\n  border-bottom-left-radius: 10upx;\n  border-bottom-right-radius: 10upx;\n}\n\n.cancel {\n\tmargin-top: 20upx;\n\tmargin-bottom: 20upx;\n}\n\n.cancel button {\n  border-radius: 10upx;\n}\n</style>"]}]}