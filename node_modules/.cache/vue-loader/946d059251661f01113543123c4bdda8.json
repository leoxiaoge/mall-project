{"remainingRequest":"/Users/lee/Desktop/github/mall-project/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-scoped-loader/index.js!/Users/lee/Desktop/github/mall-project/src/pages/ucenter/recharge/recharge.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lee/Desktop/github/mall-project/src/pages/ucenter/recharge/recharge.vue","mtime":1562520451054},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/cache-loader/dist/cjs.js","mtime":1554990705312},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/babel-loader/lib/index.js","mtime":1560261191357},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js","mtime":1561751947145},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js","mtime":1561751947145},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/cache-loader/dist/cjs.js","mtime":1554990705312},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/vue-loader/lib/index.js","mtime":1554990705750},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-scoped-loader/index.js","mtime":1561751947145}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { request, navigateTo } from \"@/common/utils/util\";\nimport {\n\tPayMoneyListGet,\n\tPayMoneySubmit,\n\tGetWXOpenID\n} from \"@/common/config/api\";\nexport default {\n\tdata() {\n\t\treturn {\n\t\t\ttitle: \"request-payment\",\n\t\t\tloading: false,\n\t\t\tprice: 1,\n\t\t\tproviderList: [],\n\t\t\tpayList: [],\n\t\t\tpayIndex: 0,\n\t\t\tMoneyID: \"\", // 支付金额对应的ID\n\t\t\tpayMoney: \"\",\n\t\t\tPayTypeID: 1, // 支付方式ID 微信小程序支付传1\n\t\t\tOpenID: \"\" // OpenID\n\t\t};\n\t},\n\tonLoad: function() {\n\t\tthis.getPayMoneyList();\n\t},\n\tmethods: {\n\t\tgetPayMoneyList() {\n\t\t\tlet data = {};\n\t\t\trequest(PayMoneyListGet, data).then(res => {\n\t\t\t\tconsole.log(res);\n\t\t\t\tthis.payList = res.PayMoneyList;\n\t\t\t\tthis.MoneyID = res.PayMoneyList[0].ID;\n\t\t\t\tthis.payMoney = res.PayMoneyList[0].PayMoney;\n\t\t\t});\n\t\t},\n\t\t// 选择支付金额\n\t\tchangePayment(index) {\n\t\t\tthis.payIndex = index;\n\t\t\tlet payList = this.payList;\n\t\t\tlet intemIndex = payList[index].ID;\n\t\t\tthis.MoneyID = intemIndex;\n\t\t\tconsole.log(intemIndex);\n\t\t\tthis.payMoney = payList[index].PayMoney;\n\t\t},\n\t\tasync payment() {\n\t\t\tconsole.log(\"发起支付\");\n\t\t\tthis.loading = true;\n\t\t\tlet payment = await this.payMoneySubmit();\n\t\t\tlet paymentData = JSON.parse(payment);\n\t\t\tconsole.log(paymentData);\n\t\t\tconsole.log(paymentData.timeStamp);\n\t\t\tuni.requestPayment({\n\t\t\t\ttimeStamp: paymentData.timeStamp,\n\t\t\t\tnonceStr: paymentData.nonceStr,\n\t\t\t\tpackage: paymentData.package,\n\t\t\t\tsignType: \"MD5\",\n\t\t\t\tpaySign: paymentData.paySign,\n\t\t\t\tsuccess: res => {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: \"充值成功！!\"\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tfail: res => {\n\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\tcontent: \"支付失败,原因为: \" + res.errMsg,\n\t\t\t\t\t\tshowCancel: false\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tcomplete: () => {\n\t\t\t\t\tthis.loading = false;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t// 获取\n\t\tgetWXOpenID() {\n\t\t\treturn new Promise((sesolve, reject) => {\n\t\t\t\tuni.login({\n\t\t\t\t\tsuccess: e => {\n\t\t\t\t\t\tconsole.log(\"login success\", e);\n\t\t\t\t\t\tlet JSCode = e.code;\n\t\t\t\t\t\tlet data = {\n\t\t\t\t\t\t\tJSCode: JSCode\n\t\t\t\t\t\t};\n\t\t\t\t\t\trequest(GetWXOpenID, data).then(res => {\n\t\t\t\t\t\t\tconsole.log(res);\n\t\t\t\t\t\t\tsesolve(res.OpenID);\n\t\t\t\t\t\t\tlet OpenID = res.OpenID;\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tfail: e => {\n\t\t\t\t\t\tconsole.log(\"fail\", e);\n\t\t\t\t\t\tthis.loading = false;\n\t\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\t\tcontent: \"支付失败,原因为: \" + e.errMsg,\n\t\t\t\t\t\t\tshowCancel: false\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t// 支付API\n\t\tasync payMoneySubmit() {\n      let OpenID = await this.getWXOpenID();\n\t\t\treturn new Promise((sesolve, reject) => {\n\t\t\t\tlet MoneyID = this.MoneyID;\n\t\t\t\tlet PayTypeID = this.PayTypeID;\n\t\t\t\tlet data = {\n\t\t\t\t\tMoneyID: MoneyID,\n\t\t\t\t\tPayTypeID: PayTypeID,\n\t\t\t\t\tOpenID: OpenID\n\t\t\t\t};\n\t\t\t\trequest(PayMoneySubmit, data).then(res => {\n\t\t\t\t\tconsole.log(res);\n\t\t\t\t\tsesolve(res.PayParam);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n};\n",{"version":3,"sources":["recharge.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAyBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"recharge.vue","sourceRoot":"src/pages/ucenter/recharge","sourcesContent":["<template>\n\t<view class=\"container\">\n\t\t<view class=\"teng-recharge\">\n\t\t\t<view\n\t\t\t\tclass=\"teng-recharge-item\"\n\t\t\t\t:class=\"{'teng-recharge-item-active':payIndex == index}\"\n\t\t\t\tv-for=\"(item, index) in payList\"\n\t\t\t\t:key=\"index\"\n\t\t\t\t@click=\"changePayment(index)\"\n\t\t\t>\n\t\t\t\t<view class=\"teng-recharge-price\">{{item.PayMoney}}元</view>\n\t\t\t\t<view class=\"teng-recharge-description\" v-if=\"item.VirtualMoney\">兑{{item.VirtualMoney}}个入场券</view>\n\t\t\t</view>\n\t\t</view>\n\t\t<view class=\"teng-recharge-bottom teng-flex-between\">\n\t\t\t<view class=\"teng-recharge-total-price\">\n\t\t\t\t<text>支付金额：</text>\n\t\t\t\t<text class=\"teng-recharge-total-price-number\">¥{{payMoney}}</text>\n\t\t\t</view>\n\t\t\t<button class=\"btn payment-btn bg-gradual-orange\" @click=\"payment\" :loading=\"loading\">支付</button>\n\t\t</view>\n\t</view>\n</template>\n\n<script>\nimport { request, navigateTo } from \"@/common/utils/util\";\nimport {\n\tPayMoneyListGet,\n\tPayMoneySubmit,\n\tGetWXOpenID\n} from \"@/common/config/api\";\nexport default {\n\tdata() {\n\t\treturn {\n\t\t\ttitle: \"request-payment\",\n\t\t\tloading: false,\n\t\t\tprice: 1,\n\t\t\tproviderList: [],\n\t\t\tpayList: [],\n\t\t\tpayIndex: 0,\n\t\t\tMoneyID: \"\", // 支付金额对应的ID\n\t\t\tpayMoney: \"\",\n\t\t\tPayTypeID: 1, // 支付方式ID 微信小程序支付传1\n\t\t\tOpenID: \"\" // OpenID\n\t\t};\n\t},\n\tonLoad: function() {\n\t\tthis.getPayMoneyList();\n\t},\n\tmethods: {\n\t\tgetPayMoneyList() {\n\t\t\tlet data = {};\n\t\t\trequest(PayMoneyListGet, data).then(res => {\n\t\t\t\tconsole.log(res);\n\t\t\t\tthis.payList = res.PayMoneyList;\n\t\t\t\tthis.MoneyID = res.PayMoneyList[0].ID;\n\t\t\t\tthis.payMoney = res.PayMoneyList[0].PayMoney;\n\t\t\t});\n\t\t},\n\t\t// 选择支付金额\n\t\tchangePayment(index) {\n\t\t\tthis.payIndex = index;\n\t\t\tlet payList = this.payList;\n\t\t\tlet intemIndex = payList[index].ID;\n\t\t\tthis.MoneyID = intemIndex;\n\t\t\tconsole.log(intemIndex);\n\t\t\tthis.payMoney = payList[index].PayMoney;\n\t\t},\n\t\tasync payment() {\n\t\t\tconsole.log(\"发起支付\");\n\t\t\tthis.loading = true;\n\t\t\tlet payment = await this.payMoneySubmit();\n\t\t\tlet paymentData = JSON.parse(payment);\n\t\t\tconsole.log(paymentData);\n\t\t\tconsole.log(paymentData.timeStamp);\n\t\t\tuni.requestPayment({\n\t\t\t\ttimeStamp: paymentData.timeStamp,\n\t\t\t\tnonceStr: paymentData.nonceStr,\n\t\t\t\tpackage: paymentData.package,\n\t\t\t\tsignType: \"MD5\",\n\t\t\t\tpaySign: paymentData.paySign,\n\t\t\t\tsuccess: res => {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: \"充值成功！!\"\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tfail: res => {\n\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\tcontent: \"支付失败,原因为: \" + res.errMsg,\n\t\t\t\t\t\tshowCancel: false\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tcomplete: () => {\n\t\t\t\t\tthis.loading = false;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t// 获取\n\t\tgetWXOpenID() {\n\t\t\treturn new Promise((sesolve, reject) => {\n\t\t\t\tuni.login({\n\t\t\t\t\tsuccess: e => {\n\t\t\t\t\t\tconsole.log(\"login success\", e);\n\t\t\t\t\t\tlet JSCode = e.code;\n\t\t\t\t\t\tlet data = {\n\t\t\t\t\t\t\tJSCode: JSCode\n\t\t\t\t\t\t};\n\t\t\t\t\t\trequest(GetWXOpenID, data).then(res => {\n\t\t\t\t\t\t\tconsole.log(res);\n\t\t\t\t\t\t\tsesolve(res.OpenID);\n\t\t\t\t\t\t\tlet OpenID = res.OpenID;\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tfail: e => {\n\t\t\t\t\t\tconsole.log(\"fail\", e);\n\t\t\t\t\t\tthis.loading = false;\n\t\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\t\tcontent: \"支付失败,原因为: \" + e.errMsg,\n\t\t\t\t\t\t\tshowCancel: false\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t// 支付API\n\t\tasync payMoneySubmit() {\n      let OpenID = await this.getWXOpenID();\n\t\t\treturn new Promise((sesolve, reject) => {\n\t\t\t\tlet MoneyID = this.MoneyID;\n\t\t\t\tlet PayTypeID = this.PayTypeID;\n\t\t\t\tlet data = {\n\t\t\t\t\tMoneyID: MoneyID,\n\t\t\t\t\tPayTypeID: PayTypeID,\n\t\t\t\t\tOpenID: OpenID\n\t\t\t\t};\n\t\t\t\trequest(PayMoneySubmit, data).then(res => {\n\t\t\t\t\tconsole.log(res);\n\t\t\t\t\tsesolve(res.PayParam);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n};\n</script>\n\n<style scoped>\npage {\n\tbackground-color: #fff;\n}\n\n.teng-recharge {\n\tdisplay: flex;\n\tjustify-content: space-around;\n\talign-items: center;\n\tflex-wrap: wrap;\n\tbackground-color: #fff;\n\tpadding: 20upx 10upx;\n}\n\n.teng-recharge-item {\n\twidth: calc(33.33% - 30upx);\n\tcolor: #333;\n\tbackground-color: #fff;\n\tborder-radius: 20upx;\n\ttext-align: center;\n\tpadding: 40upx 0;\n\tborder: 2upx solid #f4f4f4;\n}\n\n.teng-recharge-item-active {\n\tcolor: #fff;\n\tbackground-color: #ff8300;\n}\n\n.teng-recharge-item-active .teng-recharge-price {\n\tcolor: #fff;\n}\n\n.teng-recharge-item-active .teng-recharge-description {\n\tcolor: #fff;\n}\n\n.teng-recharge-price {\n\tfont-size: 36upx;\n\tcolor: #333;\n}\n\n.teng-recharge-description {\n\tfont-size: 24upx;\n\tcolor: #5a5a5a;\n}\n\n.teng-recharge-bottom {\n\tposition: fixed;\n\tbottom: 0;\n\twidth: 100%;\n\theight: 100upx;\n\tbackground-color: #f4f4f4;\n}\n\n.teng-recharge-total-price {\n\tfont-size: 32upx;\n\tpadding: 0 30upx;\n}\n\n.teng-recharge-total-price-number {\n\tcolor: #ff0000;\n}\n\n.payment-btn {\n\twidth: 240upx;\n\tmargin: 0;\n\tborder: none;\n\tborder-radius: 0;\n\tline-height: 100upx;\n}\n</style>\n"]}]}