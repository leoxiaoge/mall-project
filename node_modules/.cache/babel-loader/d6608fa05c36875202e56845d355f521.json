{"remainingRequest":"/Users/lee/Desktop/github/mall-project/node_modules/babel-loader/lib/index.js!/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-2!/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--18-0!/Users/lee/Desktop/github/mall-project/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/lee/Desktop/github/mall-project/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-scoped-loader/index.js!/Users/lee/Desktop/github/mall-project/src/pages/ucenter/recharge/recharge.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lee/Desktop/github/mall-project/src/pages/ucenter/recharge/recharge.vue","mtime":1570196832536},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/cache-loader/dist/cjs.js","mtime":1554990705312},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/babel-loader/lib/index.js","mtime":1560261191357},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js","mtime":1563798331564},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js","mtime":1563798331564},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/cache-loader/dist/cjs.js","mtime":1554990705312},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/vue-loader/lib/index.js","mtime":1563798333387},{"path":"/Users/lee/Desktop/github/mall-project/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-scoped-loader/index.js","mtime":1563798331564}],"contextDependencies":[],"result":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"/Users/lee/Desktop/github/mall-project/node_modules/@babel/runtime/regenerator\"));\n\nvar _util = require(\"@/common/utils/util\");\n\nvar _api = require(\"@/common/config/api\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nvar _default = {\n  data: function data() {\n    return {\n      title: \"request-payment\",\n      loading: false,\n      price: 1,\n      color: \"#fe7f00\",\n      current: 0,\n      providerList: [{\n        name: \"微信\",\n        id: \"wxpay\",\n        value: \"wxpay\",\n        icon: \"/static/icon/icon_wxpay.png\"\n      }, {\n        name: \"支付宝\",\n        id: \"alipay\",\n        value: \"alipay\",\n        icon: \"/static/icon/icon_alipay.png\"\n      }],\n      payList: [],\n      payIndex: 0,\n      moneyID: \"\",\n      // 支付金额对应的ID\n      payMoney: \"\",\n      payTypeID: 1 // 支付方式ID 微信小程序支付传1\n\n    };\n  },\n  onLoad: function onLoad() {\n    this.getPayMoneyList();\n    this.getProvider();\n  },\n  onShareAppMessage: function onShareAppMessage(e) {\n    return (0, _util.onShareAppMessage)(e);\n  },\n  methods: {\n    getProvider: function getProvider() {\n      uni.getProvider({\n        service: \"payment\",\n        success: function success(e) {\n          console.log(\"payment success:\" + JSON.stringify(e));\n          var providerList = [];\n          e.provider.map(function (value) {\n            switch (value) {\n              case \"wxpay\":\n                providerList.push({\n                  name: \"微信\",\n                  icon: \"/static/icon/icon_wxpay.png\",\n                  id: value,\n                  value: value,\n                  loading: false\n                });\n                break;\n\n              case \"alipay\":\n                providerList.push({\n                  name: \"支付宝\",\n                  icon: \"/static/icon/icon_alipay.png\",\n                  id: value,\n                  value: value,\n                  loading: false\n                });\n                break;\n\n              default:\n                break;\n            }\n          }); // this.providerList = providerList;\n        },\n        fail: function fail(e) {\n          console.log(\"获取支付通道失败：\", e);\n        }\n      });\n    },\n    getPayMoneyList: function getPayMoneyList() {\n      var _this = this;\n\n      var data = {};\n      (0, _util.request)(_api.PayMoneyListGet, data).then(function (res) {\n        console.log(res);\n        _this.payList = res.PayMoneyList;\n        _this.moneyID = res.PayMoneyList[0].ID;\n        _this.payMoney = res.PayMoneyList[0].PayMoney;\n      });\n    },\n    // 选择支付金额\n    changePayment: function changePayment(index) {\n      this.payIndex = index;\n      var payList = this.payList;\n      var intemIndex = payList[index].ID;\n      this.moneyID = intemIndex;\n      console.log(intemIndex);\n      this.payMoney = payList[index].PayMoney;\n    },\n    payment: function () {\n      var _payment = _asyncToGenerator(\n      /*#__PURE__*/\n      _regenerator.default.mark(function _callee() {\n        var _this2 = this;\n\n        var payment, paymentData;\n        return _regenerator.default.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                console.log(\"发起支付\");\n                this.loading = true;\n                _context.next = 4;\n                return this.payMoneySubmit();\n\n              case 4:\n                payment = _context.sent;\n                paymentData = JSON.parse(payment);\n                console.log(paymentData);\n                console.log(paymentData.timeStamp);\n                uni.requestPayment({\n                  timeStamp: paymentData.timeStamp,\n                  nonceStr: paymentData.nonceStr,\n                  package: paymentData.package,\n                  signType: \"MD5\",\n                  paySign: paymentData.paySign,\n                  success: function success(res) {\n                    showToast(\"充值成功！\");\n                  },\n                  fail: function fail(res) {\n                    (0, _util.showModal)(\"支付失败，用户取消支付！\");\n                  },\n                  complete: function complete() {\n                    _this2.loading = false;\n                  }\n                });\n\n              case 9:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function payment() {\n        return _payment.apply(this, arguments);\n      }\n\n      return payment;\n    }(),\n    paymentH5: function () {\n      var _paymentH = _asyncToGenerator(\n      /*#__PURE__*/\n      _regenerator.default.mark(function _callee2() {\n        var payment, paymentData;\n        return _regenerator.default.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                this.loading = true;\n                _context2.next = 3;\n                return this.payMoneySubmit();\n\n              case 3:\n                payment = _context2.sent;\n                paymentData = JSON.parse(payment);\n\n              case 5:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function paymentH5() {\n        return _paymentH.apply(this, arguments);\n      }\n\n      return paymentH5;\n    }(),\n    // 获取OpenID\n    getWXOpenID: function getWXOpenID() {\n      var _this3 = this;\n\n      return new Promise(function (sesolve, reject) {\n        uni.login({\n          success: function success(e) {\n            console.log(\"login success\", e);\n            var JSCode = e.code;\n            var data = {\n              JSCode: JSCode\n            };\n            (0, _util.request)(_api.GetWXOpenID, data).then(function (res) {\n              console.log(res);\n              sesolve(res.OpenID);\n            });\n          },\n          fail: function fail(e) {\n            console.log(\"fail\", e);\n            _this3.loading = false;\n          }\n        });\n      });\n    },\n    // 小程序消息模版FormID\n    formSubmit: function formSubmit(e) {\n      var formId = e.detail.formId;\n      var data = {\n        FormID: formId\n      };\n      (0, _util.request)(_api.AddUserFormID, data).then(function (res) {\n        console.log(res);\n      });\n    },\n    // 支付API\n    payMoneySubmit: function () {\n      var _payMoneySubmit = _asyncToGenerator(\n      /*#__PURE__*/\n      _regenerator.default.mark(function _callee3() {\n        var _this4 = this;\n\n        var OpenID;\n        return _regenerator.default.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return this.getWXOpenID();\n\n              case 2:\n                OpenID = _context3.sent;\n                return _context3.abrupt(\"return\", new Promise(function (sesolve, reject) {\n                  var MoneyID = _this4.moneyID;\n                  var PayTypeID = _this4.payTypeID;\n                  var data = {\n                    MoneyID: MoneyID,\n                    PayTypeID: PayTypeID,\n                    OpenID: OpenID\n                  };\n                  (0, _util.request)(_api.PayMoneySubmit, data).then(function (res) {\n                    console.log(res);\n                    sesolve(res.PayParam);\n                  });\n                }));\n\n              case 4:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function payMoneySubmit() {\n        return _payMoneySubmit.apply(this, arguments);\n      }\n\n      return payMoneySubmit;\n    }(),\n    // APP支付\n    getOrderInfo: function getOrderInfo() {\n      var _this5 = this;\n\n      var appid = \"\";\n      return new Promise(function (sesolve, reject) {\n        var MoneyID = _this5.moneyID;\n        var PayTypeID = _this5.payTypeID;\n        var data = {\n          MoneyID: MoneyID,\n          PayTypeID: PayTypeID,\n          appid: appid\n        };\n        (0, _util.request)(_api.PayMoneySubmit, data).then(function (res) {\n          console.log(res);\n          sesolve(res);\n        });\n      });\n    }\n  }\n};\nexports.default = _default;",{"version":3,"sources":["recharge.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n\t<view class=\"container\">\n\t\t<view class=\"teng-recharge\">\n\t\t\t<view\n\t\t\t\tclass=\"teng-recharge-item\"\n\t\t\t\t:class=\"{'teng-recharge-item-active':payIndex == index}\"\n\t\t\t\tv-for=\"(item, index) in payList\"\n\t\t\t\t:key=\"index\"\n\t\t\t\t@click=\"changePayment(index)\"\n\t\t\t>\n\t\t\t\t<view class=\"teng-recharge-price\">{{item.PayMoney}}元</view>\n\t\t\t\t<view class=\"teng-recharge-description\" v-if=\"item.VirtualMoney\">兑{{item.VirtualMoney}}个入场券</view>\n\t\t\t</view>\n\t\t</view>\n\t\t<!-- #ifdef APP-PLUS -->\n\t\t<view class=\"payment-method\">\n\t\t\t<view class=\"payment-method-head\">\n\t\t\t\t<text>选择支付方式</text>\n\t\t\t</view>\n\t\t\t<radio-group @change=\"radioChange\">\n\t\t\t\t<label\n\t\t\t\t\tclass=\"uni-list-cell uni-list-cell-pd\"\n\t\t\t\t\tv-for=\"(item, index) in providerList\"\n\t\t\t\t\t:key=\"index\"\n\t\t\t\t>\n\t\t\t\t\t<view class=\"payment-method-item\">\n\t\t\t\t\t\t<view class=\"payment-method-icon\">\n\t\t\t\t\t\t\t<img :src=\"item.icon\" />\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"payment-method-name\">{{item.name}}</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view>\n\t\t\t\t\t\t<radio :value=\"item.value\" :checked=\"index === current\" :color=\"color\" />\n\t\t\t\t\t</view>\n\t\t\t\t</label>\n\t\t\t</radio-group>\n\t\t</view>\n\t\t<!-- #endif -->\n\t\t<!-- #ifdef MP-WEIXIN -->\n\t\t<form @submit=\"formSubmit\" report-submit=\"true\" report-submit-timeout=\"“2”\">\n\t\t\t<!-- #endif -->\n\t\t\t<view class=\"teng-recharge-bottom teng-flex-between\">\n\t\t\t\t<view class=\"teng-recharge-total-price\">\n\t\t\t\t\t<text>支付金额：</text>\n\t\t\t\t\t<text class=\"teng-recharge-total-price-number\">¥{{payMoney}}</text>\n\t\t\t\t</view>\n\t\t\t\t<!-- #ifdef MP-WEIXIN -->\n\t\t\t\t<button\n\t\t\t\t\tclass=\"btn payment-btn bg-gradual-orange\"\n\t\t\t\t\tformType=\"submit\"\n\t\t\t\t\t@click=\"payment\"\n\t\t\t\t\t:loading=\"loading\"\n\t\t\t\t>支付</button>\n\t\t\t\t<!-- #endif -->\n\t\t\t\t<!-- #ifdef H5 -->\n\t\t\t\t<button class=\"btn payment-btn bg-gradual-orange\" @click=\"paymentH5\" :loading=\"loading\">支付</button>\n\t\t\t\t<!-- #endif -->\n\t\t\t\t<!-- #ifdef APP-PLUS -->\n\t\t\t\t<button class=\"btn payment-btn bg-gradual-orange\" @click=\"requestPayment\" :loading=\"loading\">支付</button>\n\t\t\t\t<!-- #endif -->\n\t\t\t</view>\n\t\t\t<!-- #ifdef MP-WEIXIN -->\n\t\t</form>\n\t\t<!-- #endif -->\n\t</view>\n</template>\n\n<script>\nimport {\n\trequest,\n\tnavigateTo,\n\tshowModal,\n\tonShareAppMessage\n} from \"@/common/utils/util\";\nimport {\n\tPayMoneyListGet,\n\tPayMoneySubmit,\n\tAddUserFormID,\n\tGetWXOpenID\n} from \"@/common/config/api\";\nexport default {\n\tdata() {\n\t\treturn {\n\t\t\ttitle: \"request-payment\",\n\t\t\tloading: false,\n\t\t\tprice: 1,\n\t\t\tcolor: \"#fe7f00\",\n\t\t\tcurrent: 0,\n\t\t\tproviderList: [\n\t\t\t\t{\n\t\t\t\t\tname: \"微信\",\n\t\t\t\t\tid: \"wxpay\",\n\t\t\t\t\tvalue: \"wxpay\",\n\t\t\t\t\ticon: \"/static/icon/icon_wxpay.png\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: \"支付宝\",\n\t\t\t\t\tid: \"alipay\",\n\t\t\t\t\tvalue: \"alipay\",\n\t\t\t\t\ticon: \"/static/icon/icon_alipay.png\"\n\t\t\t\t}\n\t\t\t],\n\t\t\tpayList: [],\n\t\t\tpayIndex: 0,\n\t\t\tmoneyID: \"\", // 支付金额对应的ID\n\t\t\tpayMoney: \"\",\n\t\t\tpayTypeID: 1 // 支付方式ID 微信小程序支付传1\n\t\t};\n\t},\n\tonLoad: function() {\n\t\tthis.getPayMoneyList();\n\t\tthis.getProvider();\n\t},\n\tonShareAppMessage(e) {\n\t\treturn onShareAppMessage(e);\n\t},\n\tmethods: {\n\t\tgetProvider() {\n\t\t\tuni.getProvider({\n\t\t\t\tservice: \"payment\",\n\t\t\t\tsuccess: e => {\n\t\t\t\t\tconsole.log(\"payment success:\" + JSON.stringify(e));\n\t\t\t\t\tlet providerList = [];\n\t\t\t\t\te.provider.map(value => {\n\t\t\t\t\t\tswitch (value) {\n\t\t\t\t\t\t\tcase \"wxpay\":\n\t\t\t\t\t\t\t\tproviderList.push({\n\t\t\t\t\t\t\t\t\tname: \"微信\",\n\t\t\t\t\t\t\t\t\ticon: \"/static/icon/icon_wxpay.png\",\n\t\t\t\t\t\t\t\t\tid: value,\n\t\t\t\t\t\t\t\t\tvalue: value,\n\t\t\t\t\t\t\t\t\tloading: false\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"alipay\":\n\t\t\t\t\t\t\t\tproviderList.push({\n\t\t\t\t\t\t\t\t\tname: \"支付宝\",\n\t\t\t\t\t\t\t\t\ticon: \"/static/icon/icon_alipay.png\",\n\t\t\t\t\t\t\t\t\tid: value,\n\t\t\t\t\t\t\t\t\tvalue: value,\n\t\t\t\t\t\t\t\t\tloading: false\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t// this.providerList = providerList;\n\t\t\t\t},\n\t\t\t\tfail: e => {\n\t\t\t\t\tconsole.log(\"获取支付通道失败：\", e);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tgetPayMoneyList() {\n\t\t\tlet data = {};\n\t\t\trequest(PayMoneyListGet, data).then(res => {\n\t\t\t\tconsole.log(res);\n\t\t\t\tthis.payList = res.PayMoneyList;\n\t\t\t\tthis.moneyID = res.PayMoneyList[0].ID;\n\t\t\t\tthis.payMoney = res.PayMoneyList[0].PayMoney;\n\t\t\t});\n\t\t},\n\t\t// 选择支付金额\n\t\tchangePayment(index) {\n\t\t\tthis.payIndex = index;\n\t\t\tlet payList = this.payList;\n\t\t\tlet intemIndex = payList[index].ID;\n\t\t\tthis.moneyID = intemIndex;\n\t\t\tconsole.log(intemIndex);\n\t\t\tthis.payMoney = payList[index].PayMoney;\n\t\t},\n\t\tasync payment() {\n\t\t\tconsole.log(\"发起支付\");\n\t\t\tthis.loading = true;\n\t\t\tlet payment = await this.payMoneySubmit();\n\t\t\tlet paymentData = JSON.parse(payment);\n\t\t\tconsole.log(paymentData);\n\t\t\tconsole.log(paymentData.timeStamp);\n\t\t\tuni.requestPayment({\n\t\t\t\ttimeStamp: paymentData.timeStamp,\n\t\t\t\tnonceStr: paymentData.nonceStr,\n\t\t\t\tpackage: paymentData.package,\n\t\t\t\tsignType: \"MD5\",\n\t\t\t\tpaySign: paymentData.paySign,\n\t\t\t\tsuccess: res => {\n\t\t\t\t\tshowToast(\"充值成功！\");\n\t\t\t\t},\n\t\t\t\tfail: res => {\n\t\t\t\t\tshowModal(\"支付失败，用户取消支付！\");\n\t\t\t\t},\n\t\t\t\tcomplete: () => {\n\t\t\t\t\tthis.loading = false;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t// #ifdef H5\n\t\tasync paymentH5() {\n\t\t\tthis.loading = true;\n\t\t\tlet payment = await this.payMoneySubmit();\n\t\t\tlet paymentData = JSON.parse(payment);\n\t\t},\n\t\t// #endif\n\t\t// 获取OpenID\n\t\tgetWXOpenID() {\n\t\t\treturn new Promise((sesolve, reject) => {\n\t\t\t\tuni.login({\n\t\t\t\t\tsuccess: e => {\n\t\t\t\t\t\tconsole.log(\"login success\", e);\n\t\t\t\t\t\tlet JSCode = e.code;\n\t\t\t\t\t\tlet data = {\n\t\t\t\t\t\t\tJSCode: JSCode\n\t\t\t\t\t\t};\n\t\t\t\t\t\trequest(GetWXOpenID, data).then(res => {\n\t\t\t\t\t\t\tconsole.log(res);\n\t\t\t\t\t\t\tsesolve(res.OpenID);\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tfail: e => {\n\t\t\t\t\t\tconsole.log(\"fail\", e);\n\t\t\t\t\t\tthis.loading = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t// 小程序消息模版FormID\n\t\tformSubmit(e) {\n\t\t\tlet formId = e.detail.formId;\n\t\t\tlet data = {\n\t\t\t\tFormID: formId\n\t\t\t};\n\t\t\trequest(AddUserFormID, data).then(res => {\n\t\t\t\tconsole.log(res);\n\t\t\t});\n\t\t},\n\t\t// 支付API\n\t\tasync payMoneySubmit() {\n\t\t\tlet OpenID = await this.getWXOpenID();\n\t\t\treturn new Promise((sesolve, reject) => {\n\t\t\t\tlet MoneyID = this.moneyID;\n\t\t\t\tlet PayTypeID = this.payTypeID;\n\t\t\t\tlet data = {\n\t\t\t\t\tMoneyID: MoneyID,\n\t\t\t\t\tPayTypeID: PayTypeID,\n\t\t\t\t\tOpenID: OpenID\n\t\t\t\t};\n\t\t\t\trequest(PayMoneySubmit, data).then(res => {\n\t\t\t\t\tconsole.log(res);\n\t\t\t\t\tsesolve(res.PayParam);\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t// APP支付\n\t\t// #ifdef APP-PLUS\n\t\tradioChange(e) {\n\t\t\tconsole.log(e);\n\t\t\tlet value = e.target.value;\n\t\t\tthis.payTypeID = value;\n\t\t},\n\t\t// #endif\n\t\t// #ifdef APP-PLUS\n\t\tasync requestPayment(e, index) {\n\t\t\tthis.loading = true;\n\t\t\tlet orderInfo = await this.getOrderInfo(e.id);\n\t\t\tconsole.log(\"得到订单信息\", orderInfo);\n\t\t\tuni.requestPayment({\n\t\t\t\tprovider: e.id,\n\t\t\t\torderInfo: orderInfo.data,\n\t\t\t\tsuccess: e => {\n\t\t\t\t\tconsole.log(\"success\", e);\n\t\t\t\t\tshowToast(\"充值成功！\");\n\t\t\t\t},\n\t\t\t\tfail: e => {\n\t\t\t\t\tconsole.log(\"fail\", e);\n\t\t\t\t\tshowModal(\"支付失败!\");\n\t\t\t\t},\n\t\t\t\tcomplete: () => {\n\t\t\t\t\tthis.loading = false;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t// #endif\n\t\tgetOrderInfo() {\n\t\t\tlet appid = \"\";\n\t\t\t// #ifdef APP-PLUS\n\t\t\tappid = plus.runtime.appid;\n\t\t\t// #endif\n\t\t\treturn new Promise((sesolve, reject) => {\n\t\t\t\tlet MoneyID = this.moneyID;\n\t\t\t\tlet PayTypeID = this.payTypeID;\n\t\t\t\tlet data = {\n\t\t\t\t\tMoneyID: MoneyID,\n\t\t\t\t\tPayTypeID: PayTypeID,\n\t\t\t\t\tappid: appid\n\t\t\t\t};\n\t\t\t\trequest(PayMoneySubmit, data).then(res => {\n\t\t\t\t\tconsole.log(res);\n\t\t\t\t\tsesolve(res);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n};\n</script>\n\n<style scoped>\npage {\n\tbackground-color: #fff;\n}\n\n.teng-recharge {\n\tdisplay: flex;\n\tjustify-content: space-around;\n\talign-items: center;\n\tflex-wrap: wrap;\n\tbackground-color: #fff;\n\tpadding: 0 10upx;\n}\n\n.teng-recharge-item {\n\twidth: calc(33.33% - 30upx);\n\tcolor: #333;\n\tbackground-color: #fff;\n\tborder-radius: 20upx;\n\ttext-align: center;\n\tmargin-top: 20upx;\n\tpadding: 40upx 0;\n\tborder: 2upx solid #f4f4f4;\n}\n\n.teng-recharge-item-active {\n\tcolor: #fff;\n\tbackground-color: #ff8300;\n}\n\n.teng-recharge-item-active .teng-recharge-price {\n\tcolor: #fff;\n}\n\n.teng-recharge-item-active .teng-recharge-description {\n\tcolor: #fff;\n}\n\n.teng-recharge-price {\n\tfont-size: 36upx;\n\tcolor: #333;\n}\n\n.teng-recharge-description {\n\tfont-size: 24upx;\n\tcolor: #5a5a5a;\n}\n\n.teng-recharge-bottom {\n\tposition: fixed;\n\tbottom: 0;\n\twidth: 100%;\n\theight: 100upx;\n\tbackground-color: #f4f4f4;\n}\n\n.teng-recharge-total-price {\n\tfont-size: 32upx;\n\tpadding: 0 30upx;\n}\n\n.teng-recharge-total-price-number {\n\tcolor: #ff0000;\n}\n\n.payment-method {\n\tpadding: 30upx 0;\n}\n\n.payment-method-head {\n\theight: 80upx;\n\tline-height: 80upx;\n\tbackground-color: #f4f4f4;\n\tmargin-top: 80upx;\n\tpadding: 0 30upx;\n}\n\n.payment-method-head text {\n\tfont-size: 32upx;\n}\n\n.payment-method-item {\n\tdisplay: flex;\n\talign-items: center;\n}\n\n.payment-method-icon {\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n}\n\n.payment-method-icon img {\n\twidth: 64upx;\n\theight: 64upx;\n}\n\n.payment-method-name {\n\tmargin-left: 20upx;\n}\n\n.payment-btn {\n\twidth: 240upx;\n\tmargin: 0;\n\tborder: none;\n\tborder-radius: 0;\n\tline-height: 100upx;\n}\n</style>\n"],"sourceRoot":"src/pages/ucenter/recharge"}]}