(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/ucenter/recharge/recharge"],{"00ea":function(e,n,t){"use strict";var o=function(){var e=this,n=e.$createElement;e._self._c},a=[];t.d(n,"a",(function(){return o})),t.d(n,"b",(function(){return a}))},"0e4a":function(e,n,t){"use strict";t.r(n);var o=t("73d5"),a=t.n(o);for(var i in o)"default"!==i&&function(e){t.d(n,e,(function(){return o[e]}))}(i);n["default"]=a.a},"32ca":function(e,n,t){"use strict";(function(e){t("6cdc"),t("921b");var n=o(t("4781"));function o(e){return e&&e.__esModule?e:{default:e}}e(n.default)}).call(this,t("543d")["createPage"])},4781:function(e,n,t){"use strict";t.r(n);var o=t("00ea"),a=t("0e4a");for(var i in a)"default"!==i&&function(e){t.d(n,e,(function(){return a[e]}))}(i);t("5744");var r=t("2877"),c=Object(r["a"])(a["default"],o["a"],o["b"],!1,null,null,null);n["default"]=c.exports},5744:function(e,n,t){"use strict";var o=t("bc9f"),a=t.n(o);a.a},"73d5":function(e,n,t){"use strict";(function(e){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=r(t("a34a")),a=t("c440"),i=t("5177");function r(e){return e&&e.__esModule?e:{default:e}}function c(e,n,t,o,a,i,r){try{var c=e[i](r),u=c.value}catch(s){return void t(s)}c.done?n(u):Promise.resolve(u).then(o,a)}function u(e){return function(){var n=this,t=arguments;return new Promise((function(o,a){var i=e.apply(n,t);function r(e){c(i,o,a,r,u,"next",e)}function u(e){c(i,o,a,r,u,"throw",e)}r(void 0)}))}}var s={data:function(){return{title:"request-payment",loading:!1,price:1,color:"#fe7f00",current:0,providerList:[{name:"微信",id:"wxpay",value:"wxpay",icon:"/static/icon/icon_wxpay.png"},{name:"支付宝",id:"alipay",value:"alipay",icon:"/static/icon/icon_alipay.png"}],payList:[],payIndex:0,moneyID:"",payMoney:"",payTypeID:1}},onLoad:function(){this.getPayMoneyList(),this.getProvider()},onShareAppMessage:function(e){return(0,a.onShareAppMessage)(e)},methods:{getProvider:function(){e.getProvider({service:"payment",success:function(e){console.log("payment success:"+JSON.stringify(e));var n=[];e.provider.map((function(e){switch(e){case"wxpay":n.push({name:"微信",icon:"/static/icon/icon_wxpay.png",id:e,value:e,loading:!1});break;case"alipay":n.push({name:"支付宝",icon:"/static/icon/icon_alipay.png",id:e,value:e,loading:!1});break;default:break}}))},fail:function(e){console.log("获取支付通道失败：",e)}})},getPayMoneyList:function(){var e=this,n={};(0,a.request)(i.PayMoneyListGet,n).then((function(n){console.log(n),e.payList=n.PayMoneyList,e.moneyID=n.PayMoneyList[0].ID,e.payMoney=n.PayMoneyList[0].PayMoney}))},changePayment:function(e){this.payIndex=e;var n=this.payList,t=n[e].ID;this.moneyID=t,console.log(t),this.payMoney=n[e].PayMoney},payment:function(){var n=u(o.default.mark((function n(){var t,i,r=this;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return console.log("发起支付"),this.loading=!0,n.next=4,this.payMoneySubmit();case 4:t=n.sent,i=JSON.parse(t),console.log(i),console.log(i.timeStamp),e.requestPayment({timeStamp:i.timeStamp,nonceStr:i.nonceStr,package:i.package,signType:"MD5",paySign:i.paySign,success:function(e){showToast("充值成功！")},fail:function(e){(0,a.showModal)("支付失败，用户取消支付！")},complete:function(){r.loading=!1}});case 9:case"end":return n.stop()}}),n,this)})));function t(){return n.apply(this,arguments)}return t}(),getJDKWXOpenID:function(){return new Promise((function(e,n){var t="wxe6bee6124bdf2d63";console.log(location.href),window.location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid="+t+"&redirect_uri="+encodeURIComponent(location.href)+"&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect")}))},getWXOpenIDH5:function(){return this.getJDKWXOpenID(),new Promise((function(e,n){var t=window.location.search,o=new Object;if(-1!=t.indexOf("?"))for(var r=t.substr(1),c=r.split("&"),u=0;u<c.length;u++)o[c[u].split("=")[0]]=unescape(c[u].split("=")[1]);var s=o,l={JSCode:s};(0,a.request)(i.GetWXOpenID,l).then((function(n){console.log(n),e(n.OpenID)}))}))},getWXOpenID:function(){var n=this;return new Promise((function(t,o){e.login({success:function(e){console.log("login success",e);var n=e.code,o={JSCode:n};(0,a.request)(i.GetWXOpenID,o).then((function(e){console.log(e),t(e.OpenID)}))},fail:function(e){console.log("fail",e),n.loading=!1}})}))},formSubmit:function(e){var n=e.detail.formId,t={FormID:n};(0,a.request)(i.AddUserFormID,t).then((function(e){console.log(e)}))},payMoneySubmit:function(){var e=u(o.default.mark((function e(){var n,t=this;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getWXOpenID();case 2:return n=e.sent,e.abrupt("return",new Promise((function(e,o){var r=t.moneyID,c=t.payTypeID,u={MoneyID:r,PayTypeID:c,OpenID:n};(0,a.request)(i.PayMoneySubmit,u).then((function(n){console.log(n),e(n.PayParam)}))})));case 4:case"end":return e.stop()}}),e,this)})));function n(){return e.apply(this,arguments)}return n}(),getOrderInfo:function(){var e=this,n="";return new Promise((function(t,o){var r=e.moneyID,c=e.payTypeID,u={MoneyID:r,PayTypeID:c,appid:n};(0,a.request)(i.PayMoneySubmit,u).then((function(e){console.log(e),t(e)}))}))}}};n.default=s}).call(this,t("543d")["default"])},bc9f:function(e,n,t){}},[["32ca","common/runtime","common/vendor"]]]);