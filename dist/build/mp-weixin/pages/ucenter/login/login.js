(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/ucenter/login/login"],{"13e3":function(e,n,t){"use strict";var o=function(){var e=this,n=e.$createElement;e._self._c},i=[];t.d(n,"a",function(){return o}),t.d(n,"b",function(){return i})},"458c":function(e,n,t){},7461:function(e,n,t){"use strict";t.r(n);var o=t("13e3"),i=t("d753");for(var r in i)"default"!==r&&function(e){t.d(n,e,function(){return i[e]})}(r);t("8603");var c=t("2877"),s=Object(c["a"])(i["default"],o["a"],o["b"],!1,null,null,null);n["default"]=s.exports},8603:function(e,n,t){"use strict";var o=t("458c"),i=t.n(o);i.a},d753:function(e,n,t){"use strict";t.r(n);var o=t("f57d"),i=t.n(o);for(var r in o)"default"!==r&&function(e){t.d(n,e,function(){return o[e]})}(r);n["default"]=i.a},f57d:function(e,n,t){"use strict";(function(e){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=a(t("a34a")),i=a(t("66fd")),r=t("2f62"),c=t("c440"),s=t("5177");function a(e){return e&&e.__esModule?e:{default:e}}function u(e,n,t,o,i,r,c){try{var s=e[r](c),a=s.value}catch(u){return void t(u)}s.done?n(a):Promise.resolve(a).then(o,i)}function l(e){return function(){var n=this,t=arguments;return new Promise(function(o,i){var r=e.apply(n,t);function c(e){u(r,o,i,c,s,"next",e)}function s(e){u(r,o,i,c,s,"throw",e)}c(void 0)})}}function f(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,o)}return t}function d(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?f(t,!0).forEach(function(n){g(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):f(t).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function g(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var h=function(){return t.e("components/uni-icon/uni-icon").then(t.bind(null,"f0ab"))},v=i.default.extend({components:{uniIcon:h},computed:d({},(0,r.mapState)(["hasLogin"])),data:function(){return{wxFace:"",wxNick:"",refUserID:"",logo:"/static/icon/icon_login.png",checked:!0,Mobile:"",LoginCode:"",loading:!1,time:"获取验证码",currentTime:60,disabled:!1,interval:""}},onLoad:function(e){console.log(this.$store.state)},onUnload:function(){var e=this.interval;clearInterval(e)},methods:d({},(0,r.mapMutations)(["login"]),{getProvider:function(){return new Promise(function(n,t){e.getProvider({service:"oauth",success:function(e){console.log(e),n(e.provider)}})})},login:function(){var n=l(o.default.mark(function n(){var t;return o.default.wrap(function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,this.getProvider();case 2:return t=n.sent,console.log(t),n.abrupt("return",new Promise(function(n,o){~t.indexOf("weixin")&&e.login({provider:"weixin",success:function(e){console.log(JSON.stringify(e));var t=e.code,o={JSCode:t};(0,c.request)(s.GetWXOpenID,o).then(function(e){console.log(e),n(e.OpenID)})}})}));case 5:case"end":return n.stop()}},n,this)}));function t(){return n.apply(this,arguments)}return t}(),mobileInput:function(e){console.log(e),this.Mobile=e.detail.value},codeInput:function(e){console.log(e),this.LoginCode=e.detail.value},getCode:function(e){var n=this;console.log(e);var t=this.Mobile;if(t){this.getLoginCode();var o=this.currentTime;this.time=o+"s后可重发",this.disabled=!0;var i=setInterval(function(){n.time=o-1+"s后可重发",o--,o<=0&&(clearInterval(i),n.time="重新获取",n.currentTime=60,n.disabled=!1)},1e3);this.interval=i}else(0,c.showToast)("手机号码不能为空！")},getLoginCode:function(){var e=this.Mobile,n={Mobile:e};(0,c.request)(s.GetLoginCode,n).then(function(e){console.log(e),(0,c.showToast)("发送成功！")})},radioClick:function(){this.checked=!this.checked},wxLogin:function(){var n=l(o.default.mark(function n(t){var i,r;return o.default.wrap(function(n){while(1)switch(n.prev=n.next){case 0:return console.log(t),i=t.detail.userInfo,this.wxFace=i.avatarUrl,this.wxNick=i.nickName,n.next=6,this.login();case 6:r=n.sent,e.setStorageSync("OpenID",r),this.userLogin();case 9:case"end":return n.stop()}},n,this)}));function t(e){return n.apply(this,arguments)}return t}(),userLogin:function(){var n=this,t=this.Mobile,o=this.LoginCode,i=this.wxFace,r=this.wxNick,a=this.refUserID;if(e.getStorageSync("scene")&&(a=e.getStorageSync("scene")),t)if(o){this.loading=!0;var u={Mobile:t,LoginCode:o,wxFace:i,wxNick:r,RefUserID:a};(0,c.request)(s.UserLogin,u).then(function(t){console.log(t),n.loading=!1;var o=t.SessionKey,i=t.UserInfo;e.setStorageSync("SessionKey",o),e.setStorageSync("UserInfo",i),(0,c.showToast)("登录成功！"),(0,c.navigateBack)(1)})}else(0,c.showToast)("验证码不能为空！");else(0,c.showToast)("手机号码不能为空！")},getuserinfo:function(e){console.log(e)}})});n.default=v}).call(this,t("543d")["default"])}},[["a773","common/runtime","common/vendor"]]]);