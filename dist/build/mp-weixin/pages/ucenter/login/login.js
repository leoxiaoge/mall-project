(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/ucenter/login/login"],{"458c":function(e,n,t){},7461:function(e,n,t){"use strict";t.r(n);var o=t("c2ad"),r=t("d753");for(var i in r)"default"!==i&&function(e){t.d(n,e,function(){return r[e]})}(i);t("8603");var c=t("2877"),s=Object(c["a"])(r["default"],o["a"],o["b"],!1,null,null,null);n["default"]=s.exports},8603:function(e,n,t){"use strict";var o=t("458c"),r=t.n(o);r.a},c2ad:function(e,n,t){"use strict";var o=function(){var e=this,n=e.$createElement;e._self._c},r=[];t.d(n,"a",function(){return o}),t.d(n,"b",function(){return r})},d753:function(e,n,t){"use strict";t.r(n);var o=t("f57d"),r=t.n(o);for(var i in o)"default"!==i&&function(e){t.d(n,e,function(){return o[e]})}(i);n["default"]=r.a},f57d:function(e,n,t){"use strict";(function(e){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=a(t("a34a")),r=a(t("66fd")),i=t("2f62"),c=t("c440"),s=t("5177");function a(e){return e&&e.__esModule?e:{default:e}}function u(e,n,t,o,r,i,c){try{var s=e[i](c),a=s.value}catch(u){return void t(u)}s.done?n(a):Promise.resolve(a).then(o,r)}function l(e){return function(){var n=this,t=arguments;return new Promise(function(o,r){var i=e.apply(n,t);function c(e){u(i,o,r,c,s,"next",e)}function s(e){u(i,o,r,c,s,"throw",e)}c(void 0)})}}function f(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,o)}return t}function d(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?f(t,!0).forEach(function(n){g(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):f(t).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function g(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var h=function(){return t.e("components/uni-icon/uni-icon").then(t.bind(null,"f0ab"))},v=r.default.extend({components:{uniIcon:h},computed:d({},(0,i.mapState)(["hasLogin"])),data:function(){return{wxFace:"",wxNick:"",refUserID:"",logo:"/static/icon/icon_login.png",checked:!0,Mobile:"",LoginCode:"",loading:!1,time:"获取验证码",currentTime:60,disabled:!1,interval:""}},onLoad:function(e){console.log(this.$store.state)},onUnload:function(){var e=this.interval;clearInterval(e)},methods:d({},(0,i.mapMutations)(["login"]),{getProvider:function(){return new Promise(function(n,t){e.getProvider({service:"oauth",success:function(e){console.log(e),n(e.provider)}})})},login:function(){var n=l(o.default.mark(function n(){var t;return o.default.wrap(function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,this.getProvider();case 2:return t=n.sent,console.log(t),n.abrupt("return",new Promise(function(n,o){~t.indexOf("weixin")&&e.login({provider:"weixin",success:function(e){console.log(JSON.stringify(e));var t=e.code,o={JSCode:t};(0,c.request)(s.GetWXOpenID,o).then(function(e){console.log(e),n(e.OpenID)})}})}));case 5:case"end":return n.stop()}},n,this)}));function t(){return n.apply(this,arguments)}return t}(),mobileInput:function(e){console.log(e),this.Mobile=e.detail.value},codeInput:function(e){console.log(e),this.LoginCode=e.detail.value},getCode:function(e){var n=this;console.log(e);var t=this.Mobile;if(t){this.getLoginCode();var o=this.currentTime;this.time=o+"s后可重发",this.disabled=!0;var r=setInterval(function(){n.time=o-1+"s后可重发",o--,o<=0&&(clearInterval(r),n.time="重新获取",n.currentTime=60,n.disabled=!1)},1e3);this.interval=r}else(0,c.showToast)("手机号码不能为空！")},getLoginCode:function(){var e=this.Mobile,n={Mobile:e};(0,c.request)(s.GetLoginCode,n).then(function(e){console.log(e),(0,c.showToast)("发送成功！")})},radioClick:function(){this.checked=!this.checked},wxLogin:function(e){console.log(e);var n=e.detail.userInfo;this.wxFace=n.avatarUrl,this.wxNick=n.nickName,this.userLogin()},userLogin:function(){var n=l(o.default.mark(function n(){var t,r,i,a,u,l,f,d=this;return o.default.wrap(function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,this.login();case 2:if(t=n.sent,console.log(t),e.setStorageSync("OpenID",t),r=this.Mobile,i=this.LoginCode,a=this.wxFace,u=this.wxNick,l=this.refUserID,e.getStorageSync("scene")&&(l=e.getStorageSync("scene")),r){n.next=14;break}return(0,c.showToast)("手机号码不能为空！"),n.abrupt("return");case 14:if(i){n.next=17;break}return(0,c.showToast)("验证码不能为空！"),n.abrupt("return");case 17:this.loading=!0,f={Mobile:r,LoginCode:i,wxFace:a,wxNick:u,RefUserID:l},(0,c.request)(s.UserLogin,f).then(function(n){console.log(n),d.loading=!1;var t=n.SessionKey,o=n.UserInfo;e.setStorageSync("SessionKey",t),e.setStorageSync("UserInfo",o),(0,c.showToast)("登录成功！"),(0,c.navigateBack)(1)});case 20:case"end":return n.stop()}},n,this)}));function t(){return n.apply(this,arguments)}return t}(),getuserinfo:function(e){console.log(e)}})});n.default=v}).call(this,t("543d")["default"])}},[["a773","common/runtime","common/vendor"]]]);