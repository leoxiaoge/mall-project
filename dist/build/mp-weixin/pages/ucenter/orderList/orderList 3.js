(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/ucenter/orderList/orderList"],{"29e9":function(e,t,r){},"3b22":function(e,t,r){"use strict";var n=function(){var e=this,t=e.$createElement;e._self._c},o=[];r.d(t,"a",function(){return n}),r.d(t,"b",function(){return o})},"42df":function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(r("a34a")),o=s(r("66fd")),a=r("c440"),i=r("5177");function s(e){return e&&e.__esModule?e:{default:e}}function c(e,t,r,n,o,a,i){try{var s=e[a](i),c=s.value}catch(u){return void r(u)}s.done?t(c):Promise.resolve(c).then(n,o)}function u(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var a=e.apply(t,r);function i(e){c(a,n,o,i,s,"next",e)}function s(e){c(a,n,o,i,s,"throw",e)}i(void 0)})}}var d=function(){return Promise.all([r.e("common/vendor"),r.e("components/mescroll-diy/mescroll-beibei")]).then(r.bind(null,"3e72"))},l=function(){return r.e("components/order-list/order-list").then(r.bind(null,"cc87"))},p=o.default.extend({components:{MescrollUni:d,mediaList:l},data:function(){return{current:"",OrderStatus:"",orderList:[],productID:"",orderID:"",PayTypeID:1,tabBars:[{name:"全部",id:0,status:"-1"},{name:"待填地址",id:1,status:"0"},{name:"待付款",id:2,status:"1"},{name:"待发货",id:3,status:"2"},{name:"待收货",id:4,status:"3"},{name:"待晒单",id:5,status:"4"}],mescroll:null}},onLoad:function(e){console.log(e);var t=e.status;this.current=t,this.OrderStatus=t,this.$store.dispatch("getUserOpenId")},onShow:function(){if(this.mescroll){var e=this.mescroll;this.downCallback(e)}},onShareAppMessage:function(e){return(0,a.onShareAppMessage)(e)},methods:{tapTab:function(e){this.current=e;var t=this.mescroll;this.downCallback(t)},downCallback:function(e){this.mescroll=e,e.resetUpScroll()},upCallback:function(e){var t=this;this.getListDataFromNet(e.num,e.size,function(r){e.endSuccess(r.length),1==e.num&&(t.orderList=[]),t.orderList=t.orderList.concat(r),console.log("orderList",r,t.orderList)},function(){e.endErr()})},getListDataFromNet:function(){var e=u(n.default.mark(function e(t,r,o,a){var i;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getOrderList(t,r);case 3:i=e.sent,o&&o(i),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),a&&a();case 10:case"end":return e.stop()}},e,this,[[0,7]])}));function t(t,r,n,o){return e.apply(this,arguments)}return t}(),getOrderList:function(e,t){var r=this;return new Promise(function(n,o){var s=r.current;if("-1"==s){var c={PageID:e,PageSize:t};(0,a.request)(i.OrderListGet,c).then(function(e){n(e.OrderList)}).catch(function(e){var t=r.mescroll;t.endErr()})}else{var u={OrderStatus:s,PageID:e,PageSize:t};(0,a.request)(i.OrderListGet,u).then(function(e){n(e.OrderList)}).catch(function(e){var t=r.mescroll;t.endErr()})}})},order:function(e){this.orderID=e},product:function(e){this.productID=e},action:function(){var e=u(n.default.mark(function e(t){var r,o,i,s,c;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:console.log("action",t),e.t0=t,e.next="填写地址"===e.t0?4:"确认收货"===e.t0?9:"去支付"===e.t0?15:"晒单"===e.t0?17:19;break;case 4:return r=this.productID,o=!0,i=this.orderID,(0,a.navigateTo)("../addressShipping/addressShipping?disabled="+o+"&orderID="+i+"&productID="+r),e.abrupt("break",19);case 9:return e.next=11,this.orderConfirmReceiving();case 11:return s=e.sent,c=this.mescroll,s.IsError?(0,a.showToast)(s.ErrMsg):((0,a.showToast)("确认收货成功！"),this.downCallback(c)),e.abrupt("break",19);case 15:return this.payment(),e.abrupt("break",19);case 17:return(0,a.navigateTo)("../orderDryingUpload/orderDryingUpload?id="+this.orderID+"&OrderID="+this.orderID),e.abrupt("break",19);case 19:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),goDetail:function(e){console.log(e),(0,a.navigateTo)("../orderDetail/orderDetail?productID="+e.ID+"&OrderID="+e.OrderID)},goOrderDrying:function(e){console.log(e),(0,a.navigateTo)("../orderDryingUpload/orderDryingUpload?productID="+e.ID+"&OrderID="+e.OrderID)},orderConfirmReceiving:function(){var e=this;return new Promise(function(t,r){var n=e.orderID,o={OrderID:n};(0,a.request)(i.OrderConfirmReceiving,o).then(function(e){t(e),console.log(e)})})},payment:function(){var t=u(n.default.mark(function t(){var r,o,i,s;return n.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.payMoneySubmit();case 2:r=t.sent,o=JSON.parse(r),i=this.productID,s=this.orderID,e.requestPayment({timeStamp:o.timeStamp,nonceStr:o.nonceStr,package:o.package,signType:"MD5",paySign:o.paySign,success:function(){(0,a.showToast)("支付成功！!"),(0,a.navigateTo)("../orderDetail/orderDetail?productID="+i+"&OrderID="+s)},fail:function(){(0,a.showModal)("支付失败，用户取消支付!")}});case 7:case"end":return t.stop()}},t,this)}));function r(){return t.apply(this,arguments)}return r}(),paymentH5:function(){var e=u(n.default.mark(function e(){var t,r,o,i,s,c,u,d,l,p;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.payMoneySubmitH5();case 2:t=e.sent,console.log("payment",t),r=JSON.parse(t),o=this.productID,i=this.orderID,s=r.mweb_url,c=window.navigator.userAgent.toLowerCase(),console.log("判断浏览器的UserAgent",c.match(/MicroMessenger/i)),"micromessenger"==c.match(/MicroMessenger/i)?(wx.config({debug:!1,appId:r.appId,timestamp:r.timeStamp,nonceStr:r.nonceStr,signature:r.paySign,jsApiList:["chooseWXPay"]}),wx.chooseWXPay({timestamp:r.timeStamp,nonceStr:r.nonceStr,package:r.package,signType:r.signType,paySign:r.paySign,success:function(e){(0,a.showToast)("支付成功！!"),(0,a.navigateTo)("../orderDetail/orderDetail?productID="+o+"&OrderID="+i)},fail:function(e){(0,a.showModal)("支付失败，用户取消支付！")},complete:function(){}})):(u=this.productID,d=this.orderID,l="https://m.tengpaisc.com/pages/ucenter/orderDetail/orderDetail?productID=".concat(u,"&OrderID=").concat(d),p="".concat(s,"&redirect_url=").concat(l),window.location.href=p);case 11:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),payMoneySubmitH5:function(){var e=u(n.default.mark(function e(){var t,r,o,s,c=this;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=window.navigator.userAgent.toLowerCase(),console.log("micromessenger"==t.match(/MicroMessenger/i)),"micromessenger"!=t.match(/MicroMessenger/i)){e.next=9;break}return r=this.$store.state.openid,o=this.orderID,s=this.PayTypeID,e.abrupt("return",new Promise(function(e,t){var n={OrderID:o,PayTypeID:s,OpenID:r};(0,a.request)(i.OrderPay,n).then(function(t){console.log(t),e(t.PayParam)})}));case 9:return e.abrupt("return",new Promise(function(e,t){var r=c.orderID,n=c.PayTypeID,o={OrderID:r,PayTypeID:n};(0,a.request)(i.OrderPay,o).then(function(t){console.log(t),e(t.PayParam)})}));case 10:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),payMoneySubmit:function(){var e=u(n.default.mark(function e(){var t,r,o;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.$store.state.openid,r=this.orderID,o=this.PayTypeID,e.abrupt("return",new Promise(function(e,n){var s={OrderID:r,PayTypeID:o,OpenID:t};(0,a.request)(i.OrderPay,s).then(function(t){console.log(t),e(t.PayParam)})}));case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()}});t.default=p}).call(this,r("543d")["default"])},"4f4d":function(e,t,r){"use strict";r.r(t);var n=r("3b22"),o=r("d54b");for(var a in o)"default"!==a&&function(e){r.d(t,e,function(){return o[e]})}(a);r("b26e");var i=r("2877"),s=Object(i["a"])(o["default"],n["a"],n["b"],!1,null,null,null);t["default"]=s.exports},b26e:function(e,t,r){"use strict";var n=r("29e9"),o=r.n(n);o.a},d54b:function(e,t,r){"use strict";r.r(t);var n=r("42df"),o=r.n(n);for(var a in n)"default"!==a&&function(e){r.d(t,e,function(){return n[e]})}(a);t["default"]=o.a}},[["e2f2","common/runtime","common/vendor"]]]);